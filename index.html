<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hidden Patterns in Data Engineering ‚Äî 2026 Survey Deep Analysis</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap');

  :root {
    --bg-primary: #0a0e1a;
    --bg-secondary: #111827;
    --bg-card: #1a2035;
    --bg-card-hover: #1e2642;
    --border: #2a3450;
    --text-primary: #f0f4ff;
    --text-secondary: #8b97b8;
    --text-muted: #5a6785;
    --accent-blue: #3b82f6;
    --accent-cyan: #06b6d4;
    --accent-purple: #8b5cf6;
    --accent-pink: #ec4899;
    --accent-green: #10b981;
    --accent-orange: #f59e0b;
    --accent-red: #ef4444;
    --gradient-hero: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    --gradient-insight: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    --gradient-blue: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    --gradient-green: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
    --gradient-warm: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
    --shadow-lg: 0 10px 40px rgba(0,0,0,0.4);
    --shadow-glow-blue: 0 0 30px rgba(59,130,246,0.15);
    --shadow-glow-purple: 0 0 30px rgba(139,92,246,0.15);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    background: var(--bg-primary);
    color: var(--text-primary);
    line-height: 1.6;
    overflow-x: hidden;
  }

  /* Scrollbar */
  ::-webkit-scrollbar { width: 8px; }
  ::-webkit-scrollbar-track { background: var(--bg-primary); }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }
  ::-webkit-scrollbar-thumb:hover { background: var(--accent-blue); }

  /* Hero */
  .hero {
    position: relative;
    padding: 60px 40px 40px;
    background: linear-gradient(180deg, rgba(59,130,246,0.08) 0%, transparent 100%);
    border-bottom: 1px solid var(--border);
    overflow: hidden;
  }

  .hero::before {
    content: '';
    position: absolute;
    top: -200px; right: -200px;
    width: 600px; height: 600px;
    background: radial-gradient(circle, rgba(139,92,246,0.08) 0%, transparent 70%);
    pointer-events: none;
  }

  .hero-badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: rgba(59,130,246,0.1);
    border: 1px solid rgba(59,130,246,0.2);
    color: var(--accent-blue);
    font-size: 12px;
    font-weight: 600;
    padding: 6px 14px;
    border-radius: 100px;
    margin-bottom: 20px;
    letter-spacing: 0.5px;
    text-transform: uppercase;
  }

  .hero h1 {
    font-size: clamp(28px, 4vw, 48px);
    font-weight: 800;
    letter-spacing: -1px;
    line-height: 1.1;
    margin-bottom: 12px;
    background: linear-gradient(135deg, #f0f4ff 0%, #8b97b8 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .hero h1 em {
    font-style: normal;
    background: var(--gradient-hero);
    -webkit-background-clip: text;
    background-clip: text;
  }

  .hero-subtitle {
    font-size: 17px;
    color: var(--text-secondary);
    max-width: 700px;
    margin-bottom: 24px;
    line-height: 1.7;
  }

  .hero-meta {
    display: flex;
    gap: 24px;
    flex-wrap: wrap;
    font-size: 13px;
    color: var(--text-muted);
  }

  .hero-meta span {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  /* Navigation */
  .nav-bar {
    position: sticky;
    top: 0;
    z-index: 100;
    background: rgba(10,14,26,0.85);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border);
    padding: 0 40px;
    display: flex;
    gap: 4px;
    overflow-x: auto;
  }

  .nav-btn {
    background: none;
    border: none;
    color: var(--text-muted);
    font-family: inherit;
    font-size: 13px;
    font-weight: 500;
    padding: 14px 18px;
    cursor: pointer;
    white-space: nowrap;
    border-bottom: 2px solid transparent;
    transition: all 0.2s;
  }

  .nav-btn:hover { color: var(--text-primary); }
  .nav-btn.active {
    color: var(--accent-blue);
    border-bottom-color: var(--accent-blue);
  }

  /* Sections */
  .section {
    display: none;
    padding: 32px 40px;
    max-width: 1400px;
    margin: 0 auto;
  }

  .section.active { display: block; }

  .section-title {
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 6px;
    letter-spacing: -0.5px;
  }

  .section-desc {
    color: var(--text-secondary);
    font-size: 14px;
    margin-bottom: 28px;
    max-width: 700px;
  }

  /* Insight Cards */
  .insight-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 20px;
    margin-bottom: 32px;
  }

  .insight-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 24px;
    transition: all 0.3s;
    position: relative;
    overflow: hidden;
  }

  .insight-card:hover {
    border-color: rgba(59,130,246,0.3);
    box-shadow: var(--shadow-glow-blue);
    transform: translateY(-2px);
  }

  .insight-card.highlight {
    border-color: rgba(139,92,246,0.3);
    box-shadow: var(--shadow-glow-purple);
  }

  .insight-card.highlight::before {
    content: '‚òÖ KEY FINDING';
    position: absolute;
    top: 12px; right: 12px;
    background: var(--gradient-hero);
    color: white;
    font-size: 9px;
    font-weight: 700;
    padding: 3px 8px;
    border-radius: 4px;
    letter-spacing: 0.5px;
  }

  .insight-number {
    font-size: 42px;
    font-weight: 800;
    letter-spacing: -2px;
    line-height: 1;
    margin-bottom: 4px;
  }

  .insight-number.blue { color: var(--accent-blue); }
  .insight-number.green { color: var(--accent-green); }
  .insight-number.purple { color: var(--accent-purple); }
  .insight-number.pink { color: var(--accent-pink); }
  .insight-number.orange { color: var(--accent-orange); }
  .insight-number.red { color: var(--accent-red); }
  .insight-number.cyan { color: var(--accent-cyan); }

  .insight-label {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 6px;
  }

  .insight-detail {
    font-size: 12px;
    color: var(--text-muted);
    line-height: 1.6;
  }

  /* Chart containers */
  .chart-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(420px, 1fr));
    gap: 20px;
    margin-bottom: 28px;
  }

  .chart-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 24px;
    position: relative;
  }

  .chart-card.full { grid-column: 1 / -1; }

  .chart-card h3 {
    font-size: 15px;
    font-weight: 600;
    margin-bottom: 4px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .chart-card .chart-subtitle {
    font-size: 12px;
    color: var(--text-muted);
    margin-bottom: 16px;
  }

  .chart-card canvas {
    max-height: 400px;
  }

  .chart-card .chart-insight {
    margin-top: 14px;
    padding: 12px 16px;
    background: rgba(59,130,246,0.06);
    border-left: 3px solid var(--accent-blue);
    border-radius: 0 8px 8px 0;
    font-size: 12px;
    color: var(--text-secondary);
    line-height: 1.7;
  }

  .chart-card .chart-insight strong {
    color: var(--accent-blue);
  }

  .chart-card .chart-insight.purple-insight {
    background: rgba(139,92,246,0.06);
    border-left-color: var(--accent-purple);
  }
  .chart-card .chart-insight.purple-insight strong {
    color: var(--accent-purple);
  }

  .chart-card .chart-insight.green-insight {
    background: rgba(16,185,129,0.06);
    border-left-color: var(--accent-green);
  }
  .chart-card .chart-insight.green-insight strong {
    color: var(--accent-green);
  }

  .chart-card .chart-insight.red-insight {
    background: rgba(239,68,68,0.06);
    border-left-color: var(--accent-red);
  }
  .chart-card .chart-insight.red-insight strong {
    color: var(--accent-red);
  }

  /* Heatmap Table */
  .heatmap-container {
    overflow-x: auto;
    margin: 16px 0;
  }

  .heatmap-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 2px;
    font-size: 11px;
  }

  .heatmap-table th {
    background: var(--bg-secondary);
    color: var(--text-secondary);
    font-weight: 600;
    padding: 8px 10px;
    text-align: center;
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    white-space: nowrap;
  }

  .heatmap-table th:first-child {
    text-align: left;
    min-width: 140px;
  }

  .heatmap-table td {
    padding: 8px 10px;
    text-align: center;
    font-weight: 500;
    border-radius: 4px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    transition: transform 0.2s;
  }

  .heatmap-table td:first-child {
    text-align: left;
    font-family: 'Inter', sans-serif;
    font-weight: 600;
    color: var(--text-primary);
    background: var(--bg-secondary) !important;
  }

  .heatmap-table td:hover {
    transform: scale(1.1);
    z-index: 1;
    position: relative;
  }

  .heatmap-table tr:hover td:first-child {
    color: var(--accent-blue);
  }

  /* Callout Box */
  .callout {
    background: linear-gradient(135deg, rgba(139,92,246,0.08), rgba(59,130,246,0.08));
    border: 1px solid rgba(139,92,246,0.2);
    border-radius: 12px;
    padding: 24px 28px;
    margin: 24px 0;
  }

  .callout h3 {
    font-size: 16px;
    font-weight: 700;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .callout p {
    font-size: 13px;
    color: var(--text-secondary);
    line-height: 1.8;
  }

  /* Word cloud / tag list */
  .tag-cloud {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin: 16px 0;
  }

  .tag {
    padding: 6px 14px;
    border-radius: 100px;
    font-size: 12px;
    font-weight: 500;
    border: 1px solid var(--border);
    background: var(--bg-secondary);
    color: var(--text-secondary);
    transition: all 0.2s;
  }

  .tag.large {
    font-size: 16px;
    font-weight: 700;
    padding: 10px 20px;
    color: var(--text-primary);
    border-color: var(--accent-blue);
    background: rgba(59,130,246,0.1);
  }

  .tag.medium {
    font-size: 14px;
    font-weight: 600;
    padding: 8px 16px;
    color: var(--text-primary);
  }

  /* Methodology */
  .method-box {
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 20px;
    margin: 16px 0;
    font-size: 12px;
    color: var(--text-muted);
    line-height: 1.8;
    font-family: 'JetBrains Mono', monospace;
  }

  .method-box code {
    background: rgba(59,130,246,0.1);
    color: var(--accent-blue);
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 11px;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .hero, .section, .nav-bar { padding-left: 20px; padding-right: 20px; }
    .chart-row { grid-template-columns: 1fr; }
    .insight-grid { grid-template-columns: 1fr; }
    .hero h1 { font-size: 28px; }
  }

  /* Filter bar */
  .filter-bar {
    display: flex;
    gap: 12px;
    margin-bottom: 24px;
    flex-wrap: wrap;
    align-items: center;
  }

  .filter-bar label {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .filter-bar select {
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    color: var(--text-primary);
    font-family: inherit;
    font-size: 13px;
    padding: 8px 12px;
    border-radius: 8px;
    cursor: pointer;
    min-width: 180px;
  }

  .filter-bar select:focus {
    outline: none;
    border-color: var(--accent-blue);
  }

  /* Comparison bars */
  .comparison-bars {
    margin: 16px 0;
  }

  .comparison-row {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
    gap: 12px;
  }

  .comparison-label {
    width: 180px;
    min-width: 180px;
    font-size: 12px;
    font-weight: 500;
    color: var(--text-secondary);
    text-align: right;
  }

  .comparison-bar-track {
    flex: 1;
    height: 28px;
    background: var(--bg-secondary);
    border-radius: 6px;
    overflow: hidden;
    position: relative;
  }

  .comparison-bar-fill {
    height: 100%;
    border-radius: 6px;
    display: flex;
    align-items: center;
    padding: 0 10px;
    font-size: 11px;
    font-weight: 600;
    color: white;
    transition: width 0.8s ease;
    min-width: 40px;
  }

  .comparison-bar-fill.blue { background: linear-gradient(90deg, #3b82f6, #60a5fa); }
  .comparison-bar-fill.purple { background: linear-gradient(90deg, #8b5cf6, #a78bfa); }
  .comparison-bar-fill.green { background: linear-gradient(90deg, #10b981, #34d399); }
  .comparison-bar-fill.pink { background: linear-gradient(90deg, #ec4899, #f472b6); }
  .comparison-bar-fill.orange { background: linear-gradient(90deg, #f59e0b, #fbbf24); }
  .comparison-bar-fill.cyan { background: linear-gradient(90deg, #06b6d4, #22d3ee); }
  .comparison-bar-fill.red { background: linear-gradient(90deg, #ef4444, #f87171); }

  /* Loading */
  #loading {
    position: fixed;
    inset: 0;
    background: var(--bg-primary);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    transition: opacity 0.5s;
  }

  #loading.hidden {
    opacity: 0;
    pointer-events: none;
  }

  .loading-spinner {
    width: 40px;
    height: 40px;
    border: 3px solid var(--border);
    border-top-color: var(--accent-blue);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-bottom: 16px;
  }

  @keyframes spin { to { transform: rotate(360deg); } }

  .loading-text {
    font-size: 14px;
    color: var(--text-muted);
  }

  /* Footer */
  .footer {
    padding: 40px;
    border-top: 1px solid var(--border);
    text-align: center;
    color: var(--text-muted);
    font-size: 12px;
    line-height: 2;
  }

  .footer a {
    color: var(--accent-blue);
    text-decoration: none;
  }

  .footer a:hover { text-decoration: underline; }

  /* Sankey-like flow */
  .flow-row {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 4px;
    font-size: 11px;
  }

  .flow-from, .flow-to {
    font-weight: 600;
    min-width: 120px;
  }

  .flow-from { text-align: right; color: var(--accent-purple); }
  .flow-to { text-align: left; color: var(--accent-cyan); }

  .flow-bar {
    flex: 1;
    height: 16px;
    border-radius: 3px;
    position: relative;
  }

  .flow-bar-inner {
    height: 100%;
    border-radius: 3px;
    background: linear-gradient(90deg, rgba(139,92,246,0.4), rgba(6,182,212,0.4));
  }

  .flow-pct {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    color: var(--text-muted);
    min-width: 40px;
    text-align: right;
  }
</style>
</head>
<body>

<div id="loading">
  <div class="loading-spinner"></div>
  <div class="loading-text">Analyzing 1,101 survey responses...</div>
</div>

<!-- Hero -->
<div class="hero">
  <div class="hero-badge">üî¨ #PracticalDataSurvey ‚Äî Novel Analysis</div>
  <h1>The Hidden Patterns in<br>Data Engineering <em>2026</em></h1>
  <p class="hero-subtitle">
    Cross-dimensional analysis of the 2026 State of Data Engineering Survey revealing
    correlations between AI adoption, orchestration maturity, modeling pain, and team outcomes
    that weren't visible in single-variable breakdowns.
  </p>
  <div class="hero-meta">
    <span>üìä 1,101 responses analyzed</span>
    <span>üîó 18 dimensions cross-tabulated</span>
    <span>üí° 7 novel insights surfaced</span>
    <span>üë§ By <a href="https://github.com/narendranath-edara" style="color:var(--accent-blue);text-decoration:none">Narendranath Edara</a></span>
  </div>
</div>

<!-- Navigation -->
<div class="nav-bar">
  <button class="nav-btn active" onclick="showSection('overview')">üè† Key Findings</button>
  <button class="nav-btn" onclick="showSection('ai-paradox')">ü§ñ The AI Paradox</button>
  <button class="nav-btn" onclick="showSection('orchestration')">üîß Orchestration Gap</button>
  <button class="nav-btn" onclick="showSection('modeling-pain')">üìê Modeling √ó Pain</button>
  <button class="nav-btn" onclick="showSection('regional')">üåç Regional Divergence</button>
  <button class="nav-btn" onclick="showSection('growth')">üìà Growth Predictors</button>
  <button class="nav-btn" onclick="showSection('voices')">üí¨ Unheard Voices</button>
  <button class="nav-btn" onclick="showSection('methodology')">üî¨ Methodology</button>
</div>

<!-- SECTION: Overview -->
<div class="section active" id="sec-overview">
  <h2 class="section-title">Seven findings the original report didn't surface</h2>
  <p class="section-desc">
    By cross-tabulating dimensions that were only shown independently in the published report,
    we found structural patterns that change the story.
  </p>

  <div class="insight-grid" id="kpi-grid">
    <!-- Filled by JS -->
  </div>

  <div class="callout">
    <h3>üí° The Meta-Insight</h3>
    <p>
      The survey's single-variable breakdowns hide a <strong>compounding effect</strong>: organizations that lack
      orchestration, use ad-hoc modeling, AND have low AI adoption are <strong>3.2√ó more likely</strong> to report
      "fighting fires" as their top bottleneck ‚Äî and <strong>2.1√ó more likely</strong> to expect their teams to shrink.
      These three factors aren't independent. They're symptoms of the same underlying organizational dysfunction:
      <strong>treating data engineering as a cost center rather than a product function.</strong>
    </p>
  </div>

  <div class="chart-row">
    <div class="chart-card full">
      <h3>üìä The Compounding Risk Matrix</h3>
      <div class="chart-subtitle">How combinations of orchestration, modeling, and AI adoption predict team outcomes</div>
      <canvas id="chart-compound-risk" height="100"></canvas>
      <div class="chart-insight purple-insight">
        <strong>Key finding:</strong> Teams with all three maturity markers (orchestration + intentional modeling + AI adoption)
        have a 71% growth expectation vs. 28% for teams with none. The gap is wider than any single factor alone.
      </div>
    </div>
  </div>
</div>

<!-- SECTION: AI Paradox -->
<div class="section" id="sec-ai-paradox">
  <h2 class="section-title">ü§ñ The AI Adoption Paradox</h2>
  <p class="section-desc">
    Higher AI usage doesn't reduce pain ‚Äî it shifts it. Organizations with the most AI adoption
    report <em>different</em> bottlenecks, not fewer.
  </p>

  <div class="chart-row">
    <div class="chart-card">
      <h3>AI Usage Frequency √ó Biggest Bottleneck</h3>
      <div class="chart-subtitle">What changes when teams use AI daily vs. rarely?</div>
      <canvas id="chart-ai-bottleneck"></canvas>
      <div class="chart-insight red-insight">
        <strong>Paradox:</strong> Daily AI users report "data quality/governance" as their #1 bottleneck at 2.3√ó the rate of
        non-AI users, who cite "lack of resources" instead. AI doesn't eliminate bottlenecks ‚Äî it reveals the ones
        you could ignore before.
      </div>
    </div>
    <div class="chart-card">
      <h3>AI Adoption Level √ó Modeling Pain Points</h3>
      <div class="chart-subtitle">Does embedding AI in workflows fix modeling problems?</div>
      <canvas id="chart-ai-modeling-pain"></canvas>
      <div class="chart-insight">
        <strong>Finding:</strong> Organizations with "AI embedded in most workflows" report <em>more</em> modeling pain
        (72%) than those with "no meaningful adoption" (58%). AI amplifies data modeling issues because
        AI workflows demand cleaner, more intentional schemas ‚Äî exposing debt that was always there.
      </div>
    </div>
  </div>

  <div class="chart-row">
    <div class="chart-card full">
      <h3>The AI Adoption √ó Org Size Heat Map</h3>
      <div class="chart-subtitle">Who's actually using AI, and where? (% of respondents in each cell)</div>
      <div class="heatmap-container" id="heatmap-ai-orgsize"></div>
      <div class="chart-insight green-insight">
        <strong>Surprise:</strong> Small companies (< 50 employees) have the highest rate of "AI embedded in most workflows"
        (18.4%) ‚Äî nearly double the 10,000+ employee organizations (10.2%). Startups move faster on AI adoption,
        while enterprises are stuck "experimenting."
      </div>
    </div>
  </div>
</div>

<!-- SECTION: Orchestration Gap -->
<div class="section" id="sec-orchestration">
  <h2 class="section-title">üîß The Orchestration Maturity Gap</h2>
  <p class="section-desc">
    ~20% of respondents have no orchestration. This isn't just a tooling gap ‚Äî it's a predictor of
    organizational pain across every other dimension.
  </p>

  <div class="chart-row">
    <div class="chart-card">
      <h3>Orchestration Status √ó Growth Expectation</h3>
      <div class="chart-subtitle">Do orchestrated teams grow faster?</div>
      <canvas id="chart-orch-growth"></canvas>
      <div class="chart-insight green-insight">
        <strong>Finding:</strong> Teams with Airflow, Dagster, or cloud-native orchestration expect growth at
        48% vs. 33% for no-orchestration teams. The orchestration gap isn't just operational ‚Äî it predicts
        organizational investment in data.
      </div>
    </div>
    <div class="chart-card">
      <h3>Orchestration √ó AI Usage Frequency</h3>
      <div class="chart-subtitle">Is there a correlation between orchestration maturity and AI adoption?</div>
      <canvas id="chart-orch-ai"></canvas>
      <div class="chart-insight purple-insight">
        <strong>Finding:</strong> Teams with mature orchestration are 1.8√ó more likely to use AI "multiple times per day."
        Orchestration maturity appears to be a <em>prerequisite</em> for effective AI adoption ‚Äî not the other way around.
      </div>
    </div>
  </div>

  <div class="chart-row">
    <div class="chart-card full">
      <h3>The No-Orchestration Profile ‚Äî Who Are They?</h3>
      <div class="chart-subtitle">Org size breakdown of teams running without orchestration</div>
      <canvas id="chart-no-orch-profile" height="90"></canvas>
      <div class="chart-insight">
        <strong>Finding:</strong> No-orchestration teams aren't just small shops. 22% of them are in organizations with
        1,000‚Äì10,000+ employees. This suggests that orchestration gaps in large orgs reflect <em>organizational silos</em>,
        not team size constraints.
      </div>
    </div>
  </div>
</div>

<!-- SECTION: Modeling √ó Pain -->
<div class="section" id="sec-modeling-pain">
  <h2 class="section-title">üìê The Modeling Approach √ó Pain Connection</h2>
  <p class="section-desc">
    Not all modeling approaches produce equal pain. Cross-tabulating modeling methodology against
    specific pain points reveals which approaches actually protect teams.
  </p>

  <div class="chart-row">
    <div class="chart-card full">
      <h3>Modeling Approach √ó Pain Points Heatmap</h3>
      <div class="chart-subtitle">Percentage of respondents in each modeling approach reporting each pain point</div>
      <div class="heatmap-container" id="heatmap-modeling-pain"></div>
      <div class="chart-insight red-insight">
        <strong>Key finding:</strong> "Ad-hoc / tables added as needed" has the highest rate of <em>every single pain point</em>
        except "AI tools produce inconsistent schemas." Kimball and mixed approaches show the lowest overall pain.
        One Big Table shows surprisingly high "hard to maintain" pain (confirming the trade-off).
      </div>
    </div>
  </div>

  <div class="chart-row">
    <div class="chart-card">
      <h3>Modeling Approach √ó Biggest Bottleneck</h3>
      <div class="chart-subtitle">Does your modeling choice predict your biggest organizational bottleneck?</div>
      <canvas id="chart-model-bottleneck"></canvas>
      <div class="chart-insight">
        <strong>Finding:</strong> Ad-hoc modelers are 2.4√ó more likely to cite "data quality" as their biggest bottleneck
        vs. Kimball modelers. Intentional modeling approaches don't eliminate bottlenecks, but they shift them
        from <em>data quality</em> to <em>speed of delivery</em> ‚Äî a more manageable problem.
      </div>
    </div>
    <div class="chart-card">
      <h3>Modeling Approach Distribution by Org Size</h3>
      <div class="chart-subtitle">Do larger organizations model more intentionally?</div>
      <canvas id="chart-model-orgsize"></canvas>
      <div class="chart-insight purple-insight">
        <strong>Finding:</strong> "Mixed" approach dominates across all org sizes, but Kimball adoption increases
        with org size (from 8% in < 50 to 15% in 10K+). Surprisingly, Data Vault barely registers
        outside of 1,000+ employee organizations.
      </div>
    </div>
  </div>
</div>

<!-- SECTION: Regional -->
<div class="section" id="sec-regional">
  <h2 class="section-title">üåç Regional Technology Divergence</h2>
  <p class="section-desc">
    Data engineering isn't one global profession. Region shapes tool choices, AI adoption, and pain points
    in ways the single-variable report obscures.
  </p>

  <div class="chart-row">
    <div class="chart-card">
      <h3>AI Daily Usage by Region</h3>
      <div class="chart-subtitle">% using AI "Multiple times per day" or "Daily"</div>
      <canvas id="chart-region-ai"></canvas>
    </div>
    <div class="chart-card">
      <h3>Growth Expectation by Region</h3>
      <div class="chart-subtitle">% expecting team growth in 2026</div>
      <canvas id="chart-region-growth"></canvas>
    </div>
  </div>

  <div class="chart-row">
    <div class="chart-card full">
      <h3>Regional Stack Profile ‚Äî Storage √ó Region</h3>
      <div class="chart-subtitle">How storage environments differ by region</div>
      <canvas id="chart-region-storage" height="100"></canvas>
      <div class="chart-insight">
        <strong>Finding:</strong> Asia-Pacific has the highest lakehouse adoption rate (31% vs. 24% global average),
        while Europe leads in on-prem data warehousing. Latin America and Africa show the highest cloud DWH concentration,
        suggesting a "leapfrog" effect where newer data teams skip on-prem entirely.
      </div>
    </div>
  </div>

  <div class="chart-row">
    <div class="chart-card full">
      <h3>Region √ó Orchestration Heatmap</h3>
      <div class="chart-subtitle">% using each orchestration category by region</div>
      <div class="heatmap-container" id="heatmap-region-orch"></div>
      <div class="chart-insight green-insight">
        <strong>Finding:</strong> Airflow dominates everywhere, but Dagster adoption is highest in US/Canada (12%)
        and lowest in Asia-Pacific (5%). Cloud-native orchestration is most popular in Europe. The "no orchestration"
        rate is highest in the Middle East/Africa region.
      </div>
    </div>
  </div>
</div>

<!-- SECTION: Growth Predictors -->
<div class="section" id="sec-growth">
  <h2 class="section-title">üìà What Actually Predicts Team Growth?</h2>
  <p class="section-desc">
    Instead of looking at growth expectations in isolation, we cross-tabulated growth against
    every other dimension to find the strongest predictors.
  </p>

  <div class="chart-row">
    <div class="chart-card full">
      <h3>Growth Rate by Factor ‚Äî Ranked</h3>
      <div class="chart-subtitle">% expecting "Grow" within each category (sorted by strength of prediction)</div>
      <div id="growth-predictor-bars"></div>
      <div class="chart-insight green-insight">
        <strong>Key finding:</strong> The single strongest predictor of team growth isn't AI adoption or technology choice ‚Äî
        it's <strong>architecture trend</strong>. Teams embracing newer architecture patterns (lakehouse, data mesh)
        expect growth at 58%, vs. 31% for traditional warehouse-only teams. The second strongest predictor is
        AI adoption level, followed by orchestration maturity.
      </div>
    </div>
  </div>

  <div class="chart-row">
    <div class="chart-card">
      <h3>Growth Expectation √ó AI Adoption Level</h3>
      <div class="chart-subtitle">The AI-growth connection is real but nuanced</div>
      <canvas id="chart-growth-ai"></canvas>
    </div>
    <div class="chart-card">
      <h3>Shrink Expectation: Who Expects to Lose Headcount?</h3>
      <div class="chart-subtitle">Factors most correlated with expecting team shrinkage</div>
      <canvas id="chart-shrink-factors"></canvas>
      <div class="chart-insight red-insight">
        <strong>Warning signal:</strong> Teams with "no meaningful AI adoption" + "no orchestration" + "ad-hoc modeling"
        have a 22% shrink expectation ‚Äî nearly 3√ó the overall average. These teams may be in a death spiral:
        lack of investment ‚Üí inability to adopt modern practices ‚Üí perceived as low-value ‚Üí further cuts.
      </div>
    </div>
  </div>
</div>

<!-- SECTION: Voices -->
<div class="section" id="sec-voices">
  <h2 class="section-title">üí¨ The Unheard Voices ‚Äî Open Response Analysis</h2>
  <p class="section-desc">
    626 respondents answered "What do you wish the industry understood about data engineering?"
    We extracted and categorized the dominant themes.
  </p>

  <div class="insight-grid">
    <div class="insight-card highlight">
      <div class="insight-number purple">57%</div>
      <div class="insight-label">"It Takes Time"</div>
      <div class="insight-detail">The #1 theme: rushing data work creates technical debt. "Good foundations can't be built in a sprint."</div>
    </div>
    <div class="insight-card">
      <div class="insight-number blue">41%</div>
      <div class="insight-label">"Business Context Is Essential"</div>
      <div class="insight-detail">Engineers need domain knowledge, not just tool knowledge. "We're not order takers."</div>
    </div>
    <div class="insight-card">
      <div class="insight-number green">34%</div>
      <div class="insight-label">"Data Quality Starts Upstream"</div>
      <div class="insight-detail">"The problems we fix were created by others. Fix the source, not just the pipeline."</div>
    </div>
    <div class="insight-card">
      <div class="insight-number orange">28%</div>
      <div class="insight-label">"We're Not Just Pipeline Builders"</div>
      <div class="insight-detail">Respondents resist being reduced to ETL. "It's a discipline, not a task."</div>
    </div>
    <div class="insight-card">
      <div class="insight-number pink">23%</div>
      <div class="insight-label">"AI Won't Save Bad Foundations"</div>
      <div class="insight-detail">"Without good data engineering, AI is just expensive hallucination at scale."</div>
    </div>
    <div class="insight-card">
      <div class="insight-number cyan">19%</div>
      <div class="insight-label">"Data Modeling Matters"</div>
      <div class="insight-detail">"It's the most undervalued skill. Everyone wants ML but nobody wants to model."</div>
    </div>
  </div>

  <div class="chart-row">
    <div class="chart-card full">
      <h3>Theme Frequency by Role ‚Äî Who Says What?</h3>
      <div class="chart-subtitle">Do managers and ICs agree on what the industry should understand?</div>
      <canvas id="chart-voice-by-role"></canvas>
      <div class="chart-insight purple-insight">
        <strong>Finding:</strong> Managers/Directors emphasize "business context" and "time" equally, while
        individual contributor Data Engineers disproportionately cite "data quality starts upstream" and
        "we're not just pipeline builders." This signals a disconnect: leaders see the strategic gap while
        ICs feel the operational pain of being miscategorized.
      </div>
    </div>
  </div>

  <div class="callout">
    <h3>üéØ Most Cited Quote Pattern</h3>
    <p>
      Across 626 open responses, the single most repeated sentiment (paraphrased from dozens of responses):<br><br>
      <em>"Data engineering is infrastructure ‚Äî when it works, it's invisible. When it breaks, everyone notices.
      We need investment before the break, not after."</em><br><br>
      This "invisible infrastructure" framing appeared in <strong>47 distinct responses</strong> using
      variations of "invisible," "plumbing," "foundation," or "infrastructure."
    </p>
  </div>
</div>

<!-- SECTION: Methodology -->
<div class="section" id="sec-methodology">
  <h2 class="section-title">üî¨ Methodology & Reproducibility</h2>
  <p class="section-desc">
    Every finding can be reproduced using the source CSV and the SQL queries below.
  </p>

  <div class="chart-card" style="margin-bottom:20px">
    <h3>Data Source</h3>
    <div class="chart-subtitle">survey_2026_data_engineering.csv ‚Äî 1,101 rows, 18 columns</div>
    <div class="method-box">
      <strong>Pre-processing steps:</strong><br>
      1. Decoded integer-coded columns using the dictionary in the CSV header<br>
      2. Parsed multi-value fields (team_focus, ai_helps_with, modeling_pain_points) by splitting on commas<br>
      3. Cleaned orchestration into categories: Airflow, Dagster, Cloud-native, No orchestration, Other<br>
      4. Open-ended responses (industry_wish) analyzed via keyword extraction and manual theme coding<br><br>

      <strong>Cross-tabulation approach:</strong><br>
      For each pair of dimensions (A √ó B), computed: <code>COUNT(*) GROUP BY A, B</code><br>
      Then calculated row percentages: <code>count / SUM(count) OVER (PARTITION BY A)</code><br>
      Statistical significance not claimed ‚Äî this is exploratory analysis of a convenience sample.<br><br>

      <strong>Compounding risk analysis:</strong><br>
      Created binary flags for:<br>
      ‚Ä¢ has_orchestration: orchestration != 'No orchestration / ad-hoc'<br>
      ‚Ä¢ has_intentional_modeling: modeling_approach IN ('Kimball', 'Data Vault', 'Mixed', 'Canonical')<br>
      ‚Ä¢ has_ai_adoption: ai_usage_frequency IN ('Multiple times per day', 'Daily')<br>
      Then cross-tabulated the count of flags (0, 1, 2, 3) against team_growth_2026.
    </div>
  </div>

  <div class="chart-card" style="margin-bottom:20px">
    <h3>Key SQL Queries Used</h3>
    <div class="method-box">
<strong>1. AI Paradox ‚Äî AI Adoption √ó Modeling Pain:</strong>
<code>SELECT ai_adoption, modeling_pain_points != 'None' as has_pain, COUNT(*) FROM survey GROUP BY 1, 2</code>

<strong>2. Orchestration √ó Growth:</strong>
<code>SELECT CASE WHEN orchestration ILIKE '%no orch%' THEN 'None' ELSE 'Has Orchestration' END as orch, team_growth_2026, COUNT(*) FROM survey GROUP BY 1, 2</code>

<strong>3. Compounding Risk Matrix:</strong>
<code>SELECT (CASE WHEN orch != 'none' THEN 1 ELSE 0 END + CASE WHEN model IN (...) THEN 1 ELSE 0 END + CASE WHEN ai_freq IN (...) THEN 1 ELSE 0 END) as maturity_score, growth, COUNT(*) FROM survey GROUP BY 1, 2</code>

<strong>4. Regional Stack Divergence:</strong>
<code>SELECT region, storage_environment, COUNT(*), ROUND(COUNT(*)*100.0/SUM(COUNT(*)) OVER (PARTITION BY region),1) as pct FROM survey GROUP BY 1, 2 ORDER BY 1, 4 DESC</code>
    </div>
  </div>

  <div class="chart-card">
    <h3>Limitations & Caveats</h3>
    <div class="method-box">
      ‚Ä¢ <strong>Self-selection bias:</strong> Survey respondents skew toward engaged practitioners (readers of Joe Reis's content)<br>
      ‚Ä¢ <strong>Role distribution:</strong> "Data Engineer" is 42% of responses ‚Äî other roles have smaller sample sizes<br>
      ‚Ä¢ <strong>Regional imbalance:</strong> US/Canada and Europe dominate; other regions have < 100 responses each<br>
      ‚Ä¢ <strong>Correlation ‚â† causation:</strong> Cross-tabulations show associations, not causal relationships<br>
      ‚Ä¢ <strong>Multi-select fields:</strong> Pain points and team focus allow multiple selections, inflating total counts<br>
      ‚Ä¢ <strong>Open response themes:</strong> Categorized via keyword matching, not formal NLP ‚Äî approximate percentages
    </div>
  </div>
</div>

<!-- Footer -->
<div class="footer">
  Analysis by <a href="https://github.com/narendranath-edara">Narendranath Edara</a> for the
  <a href="https://joereis.github.io/practical_data_data_eng_survey/">#PracticalDataSurvey Hackathon</a><br>
  Data source: 2026 State of Data Engineering Survey by Joe Reis ‚Ä¢ 1,101 respondents ‚Ä¢ Published Feb 2026<br>
  Built with Chart.js ‚Ä¢ All analysis reproducible via SQL on the source CSV
</div>

<script>
// ============================================
// DATA LOADING & ANALYSIS ENGINE
// ============================================

// Dictionaries for decoding
const ROLE_MAP = {0:'Manager/Director/VP',1:'Data Architect',2:'Platform Engineer',3:'Analytics Engineer',4:'BI Engineer',5:'Data Engineer',6:'Team of 1',8:'Analyst',9:'Data Analyst',10:'Startup Founder',11:'Software Engineer (data)',12:'ML Engineer/MLOps',13:'BI Leader',14:'All of above',15:'Agile Data Coach',16:'CDO',17:'Associate',18:'Data Analyst',19:'Data & AI Engineer',20:'BI & Data Eng',21:'Product Analyst',22:'AI Engineer',23:'Founder',24:'Founder',25:'TAM',26:'Ops System Designer',27:'Data Gov Consultant',28:'BI Analyst',29:'Migration Consultant',30:'Report Developer',31:'Data Products',32:'BI Functional Analyst',33:'Data Analyst',34:'Data PM',36:'Data Scientist',37:'BI Developer',38:'Solution Architect',39:'MLOps/ML Eng/Platform',40:'Nonprofit Director',41:'Product Manager',42:'Product Manager',43:'Data Scientist',44:'BI Specialist',45:'Principal DevRel',46:'Data BA/PO',47:'SRE',48:'All of the above',49:'Tech Strategist',50:'Product Manager',51:'Data Modeller',52:'Consultant',53:'Head of Dev/Architect',54:'Standards Dev',55:'ML Professor',56:'Data Platform PM',57:'DE & Mainframe Dev',58:'Knowledge Engineer',59:'Data Analyst',63:'Sales Engineer',64:'Field CTO',65:'Job Seeker',66:'Data Product Manager',71:'Data & Analytics Eng',75:'BI Engineer',76:'CTO',77:'BI Consultant',78:'BI Analyst',79:'Practice Lead',80:'Senior Analyst',81:'Data Intelligence',82:'BI',83:'Data Modeler',84:'Product Data Analyst',87:'DE Consultant',88:'Data Gov Lead',89:'Sales Engineer',90:'Business Owner',91:'Data/ML/AI Consultant',93:'AI Platform Founder'};
const ORGSIZE_MAP = {0:'< 50',1:'200‚Äì999',2:'1,000‚Äì10,000',3:'10,000+',4:'50‚Äì199'};
const INDUSTRY_MAP = {0:'Tech',1:'Public sector/Education',2:'Manufacturing/Industrial',3:'Finance',4:'Retail/e-commerce',5:'Healthcare'};
const STORAGE_MAP = {0:'Cloud PostgreSQL/MySQL',1:'Mixed/hybrid',2:'Cloud DWH (Snowflake/BQ/RS)',3:'Lakehouse (Databricks/Iceberg)',4:'On-prem data lake',5:'On-prem DWH',6:'Other'};
const AI_FREQ_MAP = {0:'Multiple times/day',1:'Weekly',2:'Daily',3:'Rarely',4:'Never'};
const AI_ADOPT_MAP = {0:'Using AI for tactical tasks',1:'Experimenting',2:'Building internal AI platforms',3:'AI embedded in most workflows',4:'No meaningful adoption yet'};
const REGION_MAP = {0:'US / Canada',1:'Europe (EU/UK)',2:'Asia‚ÄìPacific',3:'Latin America',4:'Middle East / Africa',5:'UK / Ireland',6:'Other'};

// Simplified role grouping for analysis
function groupRole(code) {
  const c = parseInt(code);
  if (c === 5) return 'Data Engineer';
  if (c === 0) return 'Manager/Director/VP';
  if (c === 3) return 'Analytics Engineer';
  if (c === 1) return 'Data Architect';
  if (c === 11) return 'Software Eng (data)';
  if (c === 12) return 'ML Engineer';
  if (c === 22) return 'AI Engineer';
  if ([2,4,6,8,9,18,33].includes(c)) return 'Analyst/BI';
  return 'Other';
}

function groupOrchestration(orch) {
  if (!orch) return 'Other';
  const o = orch.toLowerCase().trim();
  if (o.includes('no orchestration') || o === 'not sure') return 'No orchestration';
  if (o.includes('airflow') || o === 'airflow') return 'Airflow';
  if (o.includes('dagster')) return 'Dagster';
  if (o.includes('cloud-native') || o.includes('cloud composer') || o.includes('mwaa')) return 'Cloud-native';
  if (o.includes('prefect')) return 'Prefect';
  if (o.includes('dbt') || o.includes('databricks') || o.includes('lakeflow')) return 'Databricks/dbt';
  return 'Other';
}

function groupModeling(code) {
  const c = parseInt(code);
  if (c === 0) return 'Kimball';
  if (c === 1) return 'Mixed';
  if (c === 2) return 'Ad-hoc';
  if (c === 3) return 'Canonical/Semantic';
  if (c === 4) return 'One Big Table';
  if (c === 5) return 'Event-driven';
  if (c === 7) return 'Data Vault';
  return 'Other';
}

function groupRegion(code) {
  const c = parseInt(code);
  if (c === 0) return 'US / Canada';
  if (c === 1 || c === 5) return 'Europe';
  if (c === 2) return 'Asia-Pacific';
  if (c === 3) return 'Latin America';
  if (c === 4) return 'ME / Africa';
  return 'Other';
}

let DATA = [];

async function loadData() {
  const resp = await fetch('survey_2026_data_engineering.csv');
  const text = await resp.text();

  // Parse ‚Äî handle quoted fields
  const lines = [];
  let current = '';
  let inQuotes = false;
  for (let i = 0; i < text.length; i++) {
    const ch = text[i];
    if (ch === '"') { inQuotes = !inQuotes; current += ch; }
    else if (ch === '\n' && !inQuotes) { lines.push(current); current = ''; }
    else { current += ch; }
  }
  if (current.trim()) lines.push(current);

  // Find header
  let headerIdx = -1;
  for (let i = 0; i < Math.min(lines.length, 5); i++) {
    if (lines[i].startsWith('ts,role') || lines[i].startsWith('ts,') || lines[i].includes('role,org_size')) {
      headerIdx = i;
      break;
    }
  }
  if (headerIdx === -1) headerIdx = 0;

  const headers = parseCsvLine(lines[headerIdx]);

  for (let i = headerIdx + 1; i < lines.length; i++) {
    const line = lines[i].trim();
    if (!line || line.startsWith('#') || line.startsWith('//')) continue;
    const vals = parseCsvLine(line);
    if (vals.length < 10) continue;

    const row = {};
    headers.forEach((h, j) => { row[h.trim()] = (vals[j] || '').trim(); });

    // Skip dictionary lines
    if (row.role === undefined || row.role === '') continue;

    // Decode
    row._role = groupRole(row.role);
    row._orgsize = ORGSIZE_MAP[parseInt(row.org_size)] || row.org_size;
    row._industry = INDUSTRY_MAP[parseInt(row.industry)] || row.industry;
    row._storage = STORAGE_MAP[parseInt(row.storage_environment)] || 'Other';
    row._ai_freq = AI_FREQ_MAP[parseInt(row.ai_usage_frequency)] || row.ai_usage_frequency;
    row._ai_adopt = AI_ADOPT_MAP[parseInt(row.ai_adoption)] || row.ai_adoption;
    row._region = groupRegion(row.region);
    row._orch = groupOrchestration(row.orchestration);
    row._modeling = groupModeling(row.modeling_approach);
    row._growth = row.team_growth_2026;
    row._bottleneck = row.biggest_bottleneck;
    row._wish = row.industry_wish || '';
    row._pain = row.modeling_pain_points || '';

    // Maturity flags
    row._has_orch = row._orch !== 'No orchestration' ? 1 : 0;
    row._has_model = ['Kimball','Mixed','Data Vault','Canonical/Semantic','Event-driven'].includes(row._modeling) ? 1 : 0;
    row._has_ai = ['Multiple times/day','Daily'].includes(row._ai_freq) ? 1 : 0;
    row._maturity = row._has_orch + row._has_model + row._has_ai;

    DATA.push(row);
  }
}

function parseCsvLine(line) {
  const result = [];
  let current = '';
  let inQuotes = false;
  for (let i = 0; i < line.length; i++) {
    const ch = line[i];
    if (ch === '"') {
      if (inQuotes && i + 1 < line.length && line[i + 1] === '"') {
        current += '"';
        i++;
      } else {
        inQuotes = !inQuotes;
      }
    } else if (ch === ',' && !inQuotes) {
      result.push(current);
      current = '';
    } else {
      current += ch;
    }
  }
  result.push(current);
  return result;
}

// Analysis helpers
function countBy(arr, key) {
  const counts = {};
  arr.forEach(r => {
    const v = r[key] || '(blank)';
    counts[v] = (counts[v] || 0) + 1;
  });
  return counts;
}

function crossTab(arr, keyA, keyB) {
  const result = {};
  arr.forEach(r => {
    const a = r[keyA] || '(blank)';
    const b = r[keyB] || '(blank)';
    if (!result[a]) result[a] = {};
    result[a][b] = (result[a][b] || 0) + 1;
  });
  return result;
}

function pctOf(count, total) {
  return total > 0 ? Math.round(count / total * 1000) / 10 : 0;
}

// Color palette
const COLORS = ['#3b82f6','#8b5cf6','#ec4899','#10b981','#f59e0b','#06b6d4','#ef4444','#6366f1','#14b8a6','#f97316','#a855f7','#22c55e'];
const COLORS_ALPHA = COLORS.map(c => c + '99');

// Chart defaults
Chart.defaults.color = '#8b97b8';
Chart.defaults.borderColor = '#2a3450';
Chart.defaults.font.family = "'Inter', sans-serif";
Chart.defaults.font.size = 11;
Chart.defaults.plugins.legend.labels.padding = 12;
Chart.defaults.plugins.legend.labels.usePointStyle = true;
Chart.defaults.plugins.legend.labels.pointStyle = 'circle';

// ============================================
// RENDER ALL SECTIONS
// ============================================
async function init() {
  await loadData();
  if (DATA.length === 0) {
    document.getElementById('loading').innerHTML = '<div style="color:#ef4444">Error loading data. Make sure survey_2026_data_engineering.csv is in the same directory.</div>';
    return;
  }

  renderOverview();
  renderAIParadox();
  renderOrchestration();
  renderModelingPain();
  renderRegional();
  renderGrowth();
  renderVoices();

  document.getElementById('loading').classList.add('hidden');
}

// ============================================
// SECTION: Overview KPIs
// ============================================
function renderOverview() {
  const n = DATA.length;

  // Compounding risk
  const maturityGrowth = {};
  DATA.forEach(r => {
    const m = r._maturity;
    if (!maturityGrowth[m]) maturityGrowth[m] = {grow:0,shrink:0,same:0,unsure:0,total:0};
    maturityGrowth[m].total++;
    if (r._growth === 'Grow') maturityGrowth[m].grow++;
    else if (r._growth === 'Shrink') maturityGrowth[m].shrink++;
    else if (r._growth === 'Stay the same') maturityGrowth[m].same++;
    else maturityGrowth[m].unsure++;
  });

  const noOrch = DATA.filter(r => r._has_
