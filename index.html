<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2026 State of Data Engineering Hackathon</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Newsreader:ital,opsz,wght@0,6..72,400;0,6..72,500;0,6..72,700;1,6..72,400&family=Outfit:wght@300;400;500;600&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root {
  --ink: #1a1a2e;
  --ink-soft: #2d2d44;
  --ink-muted: #6b6b88;
  --ink-faint: #9898b0;
  --paper: #faf9f7;
  --paper-warm: #f4f1ec;
  --paper-deep: #eae5de;
  --accent: #0f7b5f;
  --accent-light: #e8f5f0;
  --accent-bright: #12a47e;
  --red: #c0392b;
  --red-light: #fdf0ee;
  --amber: #d4850e;
  --amber-light: #fef8ee;
  --blue: #2563eb;
  --blue-light: #eff4ff;
  --font-serif: 'Newsreader', Georgia, 'Times New Roman', serif;
  --font-sans: 'Outfit', -apple-system, 'Segoe UI', sans-serif;
  --font-mono: 'IBM Plex Mono', 'Menlo', monospace;
  --radius: 8px;
  --shadow-sm: 0 1px 3px rgba(0,0,0,0.06);
  --shadow-md: 0 4px 16px rgba(0,0,0,0.08);
  --shadow-lg: 0 8px 32px rgba(0,0,0,0.1);
}
*{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{background:var(--paper);color:var(--ink);font-family:var(--font-sans);font-size:15px;line-height:1.65;-webkit-font-smoothing:antialiased;}

::-webkit-scrollbar{width:6px;}
::-webkit-scrollbar-track{background:var(--paper);}
::-webkit-scrollbar-thumb{background:var(--paper-deep);border-radius:3px;}
::-webkit-scrollbar-thumb:hover{background:var(--ink-muted);}

/* LAYOUT */
.layout{display:flex;min-height:100vh;}
.sidebar{width:256px;background:var(--ink);color:#ccc;position:fixed;top:0;left:0;bottom:0;z-index:100;display:flex;flex-direction:column;transition:transform .3s ease;}
.main-col{margin-left:256px;flex:1;min-width:0;}

/* SIDEBAR */
.sb-head{padding:22px 18px 14px;border-bottom:1px solid rgba(255,255,255,.08);}
.sb-title{font-family:var(--font-serif);font-size:16px;color:#fff;font-weight:700;line-height:1.3;}
.sb-sub{font-size:11px;color:rgba(255,255,255,.4);font-family:var(--font-mono);margin-top:3px;letter-spacing:.3px;}
.sb-filters{flex:1;overflow-y:auto;padding:14px 16px;}
.sb-group{margin-bottom:12px;}
.sb-label{font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:1.2px;color:rgba(255,255,255,.35);margin-bottom:4px;}
.sb-select{width:100%;background:rgba(255,255,255,.06);color:#ddd;border:1px solid rgba(255,255,255,.1);padding:7px 10px;border-radius:5px;font-family:var(--font-sans);font-size:12px;cursor:pointer;transition:border-color .2s;-webkit-appearance:none;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' fill='%23888'%3E%3Cpath d='M1 3l4 4 4-4'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 8px center;}
.sb-select:hover,.sb-select:focus{border-color:var(--accent-bright);outline:none;}
.sb-actions{padding:12px 16px;border-top:1px solid rgba(255,255,255,.08);display:flex;gap:6px;}
.sb-btn{flex:1;padding:8px;border:none;border-radius:5px;font-family:var(--font-mono);font-size:11px;cursor:pointer;transition:all .15s;}
.sb-btn-apply{background:var(--accent-bright);color:#fff;}
.sb-btn-apply:hover{background:var(--accent);}
.sb-btn-reset{background:transparent;border:1px solid rgba(255,255,255,.15);color:rgba(255,255,255,.5);}
.sb-btn-reset:hover{border-color:var(--red);color:var(--red);}
.sb-count{text-align:center;padding:10px;font-family:var(--font-mono);font-size:11px;color:rgba(255,255,255,.3);border-top:1px solid rgba(255,255,255,.06);}
.sb-count b{color:var(--accent-bright);font-size:13px;}

/* TABS */
.tab-strip{background:#fff;border-bottom:1px solid #e5e2dc;padding:0 28px;display:flex;position:sticky;top:0;z-index:50;box-shadow:var(--shadow-sm);}
.tab{padding:14px 18px;background:none;border:none;color:var(--ink-muted);font-family:var(--font-sans);font-size:13px;font-weight:500;cursor:pointer;position:relative;transition:color .2s;}
.tab:hover{color:var(--ink);}
.tab.on{color:var(--accent);}
.tab.on::after{content:'';position:absolute;bottom:0;left:10px;right:10px;height:2px;background:var(--accent);border-radius:1px 1px 0 0;}
.pane{display:none;}.pane.on{display:block;}

/* HERO */
.hero{max-width:960px;margin:0 auto;padding:48px 32px 36px;}
.hero-eyebrow{font-family:var(--font-mono);font-size:11px;letter-spacing:2px;text-transform:uppercase;color:var(--accent);margin-bottom:12px;opacity:0;animation:fadeUp .6s ease .1s forwards;}
.hero h1{font-family:var(--font-serif);font-size:clamp(28px,4vw,42px);font-weight:700;line-height:1.2;color:var(--ink);margin-bottom:14px;opacity:0;animation:fadeUp .7s ease .2s forwards;}
.hero-lead{font-size:17px;color:var(--ink-muted);max-width:640px;font-weight:300;line-height:1.7;opacity:0;animation:fadeUp .7s ease .35s forwards;}
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}

/* FINDINGS BOX */
.findings-box{max-width:960px;margin:0 auto 20px;padding:0 32px;}
.findings-card{background:#fff;border:1px solid #e5e2dc;border-radius:var(--radius);padding:28px 32px;box-shadow:var(--shadow-sm);}
.findings-title{font-family:var(--font-serif);font-size:20px;font-weight:700;margin-bottom:6px;color:var(--ink);}
.findings-subtitle{font-size:13px;color:var(--ink-faint);margin-bottom:20px;}
.finding{display:flex;gap:16px;padding:14px 0;border-bottom:1px solid #f0ede8;opacity:0;transform:translateY(10px);transition:all .5s ease;}
.finding.visible{opacity:1;transform:translateY(0);}
.finding:last-child{border-bottom:none;padding-bottom:0;}
.finding-num{font-family:var(--font-mono);font-size:12px;font-weight:500;color:var(--accent);min-width:24px;padding-top:2px;}
.finding-body{}
.finding-headline{font-family:var(--font-serif);font-size:16px;font-weight:700;line-height:1.35;margin-bottom:3px;}
.finding-detail{font-size:13px;color:var(--ink-muted);line-height:1.55;}
.finding-detail em{font-style:normal;color:var(--accent);font-weight:500;}
.finding .tag{display:inline-block;font-family:var(--font-mono);font-size:9px;text-transform:uppercase;letter-spacing:1px;padding:2px 6px;border-radius:3px;margin-left:8px;vertical-align:middle;font-weight:600;}
.tag-red{background:var(--red-light);color:var(--red);}
.tag-green{background:var(--accent-light);color:var(--accent);}
.tag-amber{background:var(--amber-light);color:var(--amber);}

/* CONTENT SECTIONS */
.content{max-width:1100px;margin:0 auto;padding:0 28px 40px;}
.sec-label{font-family:var(--font-mono);font-size:10px;letter-spacing:2px;text-transform:uppercase;color:var(--ink-faint);margin-bottom:6px;}
.sec-title{font-family:var(--font-serif);font-size:22px;font-weight:700;margin-bottom:20px;}
.sec-divider{height:1px;background:linear-gradient(to right,#e0dbd4,transparent);margin:36px 0 28px;}

/* DONUT ROW */
.donut-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:16px;margin-bottom:32px;}
.donut-card{background:#fff;border:1px solid #e5e2dc;border-radius:var(--radius);padding:18px 14px;text-align:center;box-shadow:var(--shadow-sm);transition:transform .2s,box-shadow .2s;cursor:default;opacity:0;transform:translateY(14px);animation:fadeUp .5s ease forwards;}
.donut-card:nth-child(1){animation-delay:.1s}.donut-card:nth-child(2){animation-delay:.18s}.donut-card:nth-child(3){animation-delay:.26s}.donut-card:nth-child(4){animation-delay:.34s}.donut-card:nth-child(5){animation-delay:.42s}
.donut-card:hover{transform:translateY(-2px);box-shadow:var(--shadow-md);}
.donut-wrap{width:120px;height:120px;margin:0 auto 10px;position:relative;}
.donut-wrap canvas{width:120px!important;height:120px!important;}
.donut-center{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-family:var(--font-mono);font-size:20px;font-weight:600;color:var(--ink);}
.donut-label{font-size:13px;font-weight:500;color:var(--ink-soft);line-height:1.35;}
.donut-sub{font-size:11px;color:var(--ink-faint);margin-top:2px;}

/* CARD GRID */
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(360px,1fr));gap:16px;margin-bottom:24px;}
.card{background:#fff;border:1px solid #e5e2dc;border-radius:var(--radius);padding:22px;box-shadow:var(--shadow-sm);transition:all .4s cubic-bezier(.22,1,.36,1);opacity:0;transform:translateY(20px);}
.card.vis{opacity:1;transform:translateY(0);}
.card:hover{box-shadow:var(--shadow-md);}
.card.w2{grid-column:span 2;}
.card.full{grid-column:1/-1;}
.card-hdr{margin-bottom:14px;}
.card-label{font-family:var(--font-mono);font-size:9px;text-transform:uppercase;letter-spacing:1.2px;color:var(--ink-faint);margin-bottom:4px;}
.card-h{font-family:var(--font-serif);font-size:17px;font-weight:700;line-height:1.3;}
.card-sub{font-size:13px;color:var(--ink-muted);margin-top:3px;}
.card-chart canvas{max-height:250px;}
.card-note{margin-top:14px;padding:12px 14px;background:var(--paper-warm);border-left:3px solid var(--accent);border-radius:0 var(--radius) var(--radius) 0;font-size:12px;line-height:1.6;color:var(--ink-muted);}
.card-note b{color:var(--accent);}

/* HEATMAP */
.heatmap-wrap{overflow-x:auto;margin:0 -4px;}
.heatmap{border-collapse:collapse;width:100%;font-size:12px;}
.heatmap th{padding:8px 10px;font-family:var(--font-mono);font-size:9px;text-transform:uppercase;letter-spacing:.8px;color:var(--ink-faint);font-weight:600;border-bottom:1px solid #e5e2dc;text-align:center;white-space:nowrap;}
.heatmap th:first-child{text-align:left;}
.heatmap td{padding:8px 10px;text-align:center;font-family:var(--font-mono);font-size:12px;border-bottom:1px solid #f0ede8;transition:all .15s;}
.heatmap td:first-child{text-align:left;font-family:var(--font-sans);font-weight:500;color:var(--ink-soft);}
.heatmap tr:hover td{background:rgba(15,123,95,.03);}
.heat-cell{border-radius:4px;display:inline-block;min-width:36px;padding:3px 6px;}

/* HORIZONTAL BARS */
.hbar{margin:2px 0;}
.hrow{display:flex;align-items:center;gap:8px;height:30px;}
.hrow-label{min-width:140px;text-align:right;font-size:12px;color:var(--ink-muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.hrow-track{flex:1;height:22px;background:var(--paper-deep);border-radius:4px;overflow:hidden;position:relative;}
.hrow-fill{height:100%;border-radius:4px;transition:width .8s cubic-bezier(.22,1,.36,1);width:0;}
.hrow-fill.go{/* width set by JS */}
.hrow-val{font-family:var(--font-mono);font-size:11px;min-width:50px;color:var(--ink-faint);font-weight:500;}
.hrow-tooltip{display:none;position:absolute;bottom:calc(100% + 6px);left:50%;transform:translateX(-50%);background:var(--ink);color:#fff;padding:4px 8px;border-radius:4px;font-size:10px;font-family:var(--font-mono);white-space:nowrap;z-index:10;pointer-events:none;}
.hrow-track:hover .hrow-tooltip{display:block;}

/* COMPARISON TABLE */
.cmp{width:100%;border-collapse:collapse;font-size:13px;}
.cmp th{text-align:left;padding:8px 12px;border-bottom:2px solid #e5e2dc;font-family:var(--font-mono);font-size:9px;text-transform:uppercase;letter-spacing:.8px;color:var(--ink-faint);font-weight:600;}
.cmp td{padding:8px 12px;border-bottom:1px solid #f0ede8;}
.cmp tr:last-child td{border-bottom:none;}
.cmp tr:hover td{background:rgba(15,123,95,.02);}
.good{color:var(--accent);font-weight:600;font-family:var(--font-mono);}
.bad{color:var(--red);font-weight:600;font-family:var(--font-mono);}
.warn{color:var(--amber);font-weight:600;font-family:var(--font-mono);}

/* CROSS-TAB */
.xt-bar{display:flex;gap:14px;align-items:flex-end;flex-wrap:wrap;padding:20px 28px;background:#fff;border-bottom:1px solid #e5e2dc;}
.xt-field label{display:block;font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:1px;color:var(--ink-faint);margin-bottom:3px;}
.xt-field select{background:#fff;color:var(--ink);border:1px solid #d5d0c8;padding:8px 28px 8px 10px;border-radius:5px;font-family:var(--font-sans);font-size:12px;cursor:pointer;-webkit-appearance:none;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' fill='%23999'%3E%3Cpath d='M1 3l4 4 4-4'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 8px center;}
.xt-field select:focus{outline:none;border-color:var(--accent);}
.xt-radio{display:flex;gap:12px;}
.xt-radio label{font-size:12px;color:var(--ink-muted);cursor:pointer;display:flex;align-items:center;gap:3px;}
.xt-radio input{accent-color:var(--accent);}
.xt-btn{padding:8px 18px;background:var(--accent);color:#fff;border:none;border-radius:5px;font-family:var(--font-mono);font-size:11px;cursor:pointer;transition:background .15s;}
.xt-btn:hover{background:var(--accent-bright);}
.xt-out{padding:20px 28px;overflow-x:auto;}
.xt-tbl{width:100%;border-collapse:collapse;font-size:11px;font-family:var(--font-mono);}
.xt-tbl th{padding:7px 8px;background:var(--paper-warm);border:1px solid #e5e2dc;font-size:9px;text-transform:uppercase;letter-spacing:.5px;color:var(--ink-faint);font-weight:600;white-space:nowrap;position:sticky;top:0;}
.xt-tbl td{padding:5px 8px;border:1px solid #eee;text-align:right;transition:background .15s;}
.xt-tbl td:first-child{text-align:left;font-weight:500;color:var(--ink);background:var(--paper);position:sticky;left:0;}
.xt-hi{background:#e0f2eb!important;color:var(--accent);font-weight:600;}
.xt-mid{background:#fef8ee!important;color:var(--amber);}
.xt-empty{text-align:center;padding:60px;color:var(--ink-faint);font-size:14px;line-height:2;}

/* EXPLORER */
.ex-bar{display:flex;gap:14px;align-items:flex-end;flex-wrap:wrap;padding:20px 28px;background:#fff;border-bottom:1px solid #e5e2dc;}
.ex-types{display:flex;gap:3px;}
.ex-type{padding:6px 12px;border:1px solid #d5d0c8;background:#fff;color:var(--ink-muted);border-radius:5px;font-size:11px;cursor:pointer;font-family:var(--font-mono);transition:all .15s;}
.ex-type.on{background:var(--accent);color:#fff;border-color:var(--accent);}
.ex-chart{padding:28px;max-width:900px;margin:0 auto;}
.ex-chart canvas{max-height:400px;}
.ex-tbl-wrap{padding:0 28px 28px;max-width:700px;margin:0 auto;}

/* DATA BROWSER */
.data-wrap{padding:16px 28px;overflow:auto;max-height:calc(100vh - 120px);}
.data-wrap table{width:100%;border-collapse:collapse;font-size:11px;}
.data-wrap th{position:sticky;top:0;background:var(--paper-warm);padding:7px 8px;border:1px solid #e5e2dc;font-family:var(--font-mono);font-size:9px;text-transform:uppercase;letter-spacing:.5px;color:var(--ink-faint);white-space:nowrap;cursor:pointer;transition:color .15s;}
.data-wrap th:hover{color:var(--accent);}
.data-wrap td{padding:4px 8px;border:1px solid #f0ede8;max-width:180px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:11px;}
.data-wrap tr:nth-child(even) td{background:var(--paper-warm);}
.data-wrap tr:hover td{background:var(--accent-light);}
.data-info{padding:10px 28px 4px;font-family:var(--font-mono);font-size:11px;color:var(--ink-faint);}

/* FOOTER */
.foot{max-width:1100px;margin:0 auto;padding:20px 28px;border-top:1px solid #e5e2dc;display:flex;justify-content:space-between;flex-wrap:wrap;gap:8px;font-size:11px;color:var(--ink-faint);}
.foot a{color:var(--accent);text-decoration:none;}.foot a:hover{text-decoration:underline;}

/* MOBILE */
.mob-btn{display:none;position:fixed;top:12px;left:12px;z-index:200;background:var(--ink);color:#fff;border:none;border-radius:6px;padding:8px 14px;font-size:16px;cursor:pointer;box-shadow:var(--shadow-md);}
@media(max-width:900px){
  .sidebar{transform:translateX(-100%);}.sidebar.open{transform:translateX(0);}
  .main-col{margin-left:0;}.mob-btn{display:block;}
  .card.w2,.card.full{grid-column:span 1;}
  .grid{grid-template-columns:1fr;}
  .donut-row{grid-template-columns:repeat(2,1fr);}
  .hero{padding:28px 20px 24px;}.content{padding:0 16px 32px;}
  .findings-box{padding:0 16px;}
}
@media(max-width:500px){.donut-row{grid-template-columns:1fr;}}

/* LOADING */
#loader{position:fixed;inset:0;background:var(--paper);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;transition:opacity .4s;}
#loader.out{opacity:0;pointer-events:none;}
.ld-bar{width:200px;height:3px;background:var(--paper-deep);border-radius:2px;overflow:hidden;margin-top:16px;}
.ld-fill{height:100%;background:var(--accent);border-radius:2px;animation:ldanim 1.5s ease infinite;}
@keyframes ldanim{0%{width:0;margin-left:0}50%{width:70%}100%{width:0;margin-left:100%}}
#loader p{font-family:var(--font-mono);font-size:11px;color:var(--ink-faint);margin-top:12px;}
</style>
</head>
<body>

<div id="loader"><div class="ld-bar"><div class="ld-fill"></div></div><p>Loading 1,101 survey responses...</p></div>
<button class="mob-btn" onclick="document.querySelector('.sidebar').classList.toggle('open')">&#9776;</button>

<div class="layout">
<aside class="sidebar" id="sidebar">
  <div class="sb-head">
    <div class="sb-title">Survey Filters</div>
    <div class="sb-sub">Slice the data, all charts update</div>
  </div>
  <div class="sb-filters">
    <div class="sb-group"><div class="sb-label">Region</div><select id="f-region" class="sb-select" onchange="apply()"><option value="all">All Regions</option></select></div>
    <div class="sb-group"><div class="sb-label">Industry</div><select id="f-industry" class="sb-select" onchange="apply()"><option value="all">All Industries</option></select></div>
    <div class="sb-group"><div class="sb-label">Org Size</div><select id="f-orgsize" class="sb-select" onchange="apply()"><option value="all">All Sizes</option></select></div>
    <div class="sb-group"><div class="sb-label">Role</div><select id="f-role" class="sb-select" onchange="apply()"><option value="all">All Roles</option></select></div>
    <div class="sb-group"><div class="sb-label">AI Adoption</div><select id="f-ai" class="sb-select" onchange="apply()"><option value="all">All Levels</option></select></div>
    <div class="sb-group"><div class="sb-label">Team Growth</div><select id="f-growth" class="sb-select" onchange="apply()"><option value="all">All</option></select></div>
  </div>
  <div class="sb-actions">
    <button class="sb-btn sb-btn-apply" onclick="apply()">Apply</button>
    <button class="sb-btn sb-btn-reset" onclick="reset()">Reset</button>
  </div>
  <div class="sb-count">Showing <b id="fc">0</b> of <b id="ft">0</b></div>
</aside>

<div class="main-col">
  <div class="tab-strip">
    <button class="tab on" onclick="switchTab('insights',this)">Key Insights</button>
    <button class="tab" onclick="switchTab('xtab',this)">Cross-Tab Builder</button>
    <button class="tab" onclick="switchTab('explore',this)">Chart Explorer</button>
    <button class="tab" onclick="switchTab('data',this)">Raw Data</button>
  </div>

  <!-- INSIGHTS PANE -->
  <div class="pane on" id="p-insights">
    <div class="hero">
      <div class="hero-eyebrow">#PracticalDataSurvey Hackathon Analysis</div>
      <h1>2026 State of Data Engineering: What the Averages Hide</h1>
      <p style="font-family:var(--font-mono);font-size:12px;color:var(--ink-muted);margin-bottom:14px;letter-spacing:0.5px;">
        by <strong style="color:var(--ink-soft);">Narendranath Edara</strong> · February 2026
      </p>
      <p class="hero-lead">The original report gave us the headline numbers. But headline numbers are averages, and averages hide the most interesting patterns. I cross-tabulated every dimension in the survey against every other one — region × bottleneck, org size × AI maturity, modeling approach × fire-fighting rate — looking for the stories that only emerge when you cut the data two ways at once. Here are five patterns the published report didn't surface. Every chart on this page recalculates live when you change the sidebar filters.</p>
    </div>
  
    <div class="findings-box">
      <div class="findings-card">
        <div class="findings-title">Five patterns the published report didn't show</div>
        <div class="findings-subtitle">These only emerge from cross-tabulations. Each finding is backed by a dedicated chart section below — scroll down to see the evidence, or use the sidebar filters to verify them yourself.</div>
  
        <div class="finding" data-delay="0"><div class="finding-num">01</div><div class="finding-body">
          <div class="finding-headline">There's a measurable doom loop: weak leadership → ad-hoc practices → constant fire-fighting <span class="tag tag-red">Root Cause</span></div>
          <div class="finding-detail">When I cross-tabulated modeling approach against daily team focus, a clear pattern emerged: teams doing ad-hoc modeling (just adding tables as needed, no plan) report fire-fighting as part of their daily work at nearly <em>twice the rate</em> of teams using structured, reusable data models. Separately, teams that cite "leadership/organizational alignment" as their biggest bottleneck are also disproportionately stuck in fire-fighting mode. These aren't independent problems — they reinforce each other. Without leadership support, teams default to ad-hoc. Ad-hoc creates technical debt. Technical debt means everything is a fire. The data suggests structured modeling practices are the clearest way to break the cycle. <b>→ See "Root Cause Analysis" section below.</b></div>
        </div></div>
  
        <div class="finding" data-delay="80"><div class="finding-num">02</div><div class="finding-body">
          <div class="finding-headline">Teams furthest along with AI report more data modeling pain, not less <span class="tag tag-red">Paradox</span></div>
          <div class="finding-detail">This one surprised me. You'd expect teams with AI embedded in most workflows to have cleaner data and fewer modeling headaches. But when I cross-tabulated AI adoption level against specific modeling pain points, teams at the highest adoption tier reported <em>more issues with inconsistent schemas and naming conventions</em> than teams still experimenting. The likely explanation: AI tools make it easy to generate pipelines and transformations quickly, but speed without modeling discipline just creates a mess faster. AI amplifies whatever practices you already have — good or bad. <b>→ See "The AI Paradox" section below.</b></div>
        </div></div>
  
        <div class="finding" data-delay="160"><div class="finding-num">03</div><div class="finding-body">
          <div class="finding-headline">Your company size predicts your biggest problem better than your tech stack does <span class="tag tag-amber">Org Size</span></div>
          <div class="finding-detail">I cross-tabulated org size against biggest bottleneck and found a striking pattern. Small companies (&lt;50 people) overwhelmingly cite <em>talent — they can't hire or retain data engineers</em>. Once you pass roughly 200 employees, the bottleneck flips: it becomes leadership alignment and legacy tech debt. Mid-size organizations (200–10,000 employees) also show the <em>lowest average AI maturity</em> of any size bracket — they're caught in the middle, too big to move fast like a startup but too small to fund dedicated AI platform teams. <b>→ See "Org Size Dynamics" section below.</b></div>
        </div></div>
  
        <div class="finding" data-delay="240"><div class="finding-num">04</div><div class="finding-body">
          <div class="finding-headline">Every region's #1 bottleneck is different — one global data strategy won't fit <span class="tag tag-amber">Strategy</span></div>
          <div class="finding-detail">The published report showed bottleneck distribution globally. But when I broke it out by region, the priorities diverged sharply. US/Canada teams are most held back by <em>legacy tech debt</em>. European teams cite <em>leadership and organizational alignment</em> most often. Asia-Pacific teams struggle with <em>poor requirements from upstream teams</em>. For any organization with teams in multiple regions, this matters: the playbook that works in one geography may miss the mark entirely in another. <b>→ See "Regional Patterns" section below.</b></div>
        </div></div>
  
        <div class="finding" data-delay="320"><div class="finding-num">05</div><div class="finding-body">
          <div class="finding-headline">On-prem teams fight fires at a significantly higher rate — a hidden cost no vendor TCO model captures <span class="tag tag-green">Hidden Cost</span></div>
          <div class="finding-detail">When I cross-tabulated storage environment against daily team focus, on-prem warehouse teams reported fire-fighting at a <em>notably higher rate than cloud warehouse or lakehouse teams</em>. This operational burden — the human cost of keeping aging infrastructure running, handling manual deployments, dealing with capacity surprises — never appears in the spreadsheet when finance compares cloud vs. on-prem costs. But it's real, it's measurable in this data, and it directly affects team morale and the ability to work on strategic projects instead of emergencies. <b>→ See the storage chart in "Root Cause Analysis" below.</b></div>
        </div></div>
      </div>
    </div>
  
    <div class="content">
      <div class="sec-divider"></div>
      <div class="sec-label">Headline Numbers</div>
      <div class="sec-title">The numbers that define data engineering in 2026</div>
      <div class="donut-row" id="donut-row">
        <div class="donut-card"><div class="donut-wrap"><canvas id="d1"></canvas><div class="donut-center" id="d1v"></div></div><div class="donut-label">Fighting Fires</div><div class="donut-sub">includes fire-fighting in daily focus</div></div>
        <div class="donut-card"><div class="donut-wrap"><canvas id="d2"></canvas><div class="donut-center" id="d2v"></div></div><div class="donut-label">Using AI Daily+</div><div class="donut-sub">daily or multiple times per day</div></div>
        <div class="donut-card"><div class="donut-wrap"><canvas id="d3"></canvas><div class="donut-center" id="d3v"></div></div><div class="donut-label">No Orchestration</div><div class="donut-sub">running ad-hoc without tooling</div></div>
        <div class="donut-card"><div class="donut-wrap"><canvas id="d4"></canvas><div class="donut-center" id="d4v"></div></div><div class="donut-label">Expect Team Growth</div><div class="donut-sub">anticipate headcount increasing in 2026</div></div>
        <div class="donut-card"><div class="donut-wrap"><canvas id="d5"></canvas><div class="donut-center" id="d5v"></div></div><div class="donut-label">Have Modeling Pain</div><div class="donut-sub">report at least one modeling pain point</div></div>
      </div>
  
      <!-- HEATMAP -->
      <div class="sec-divider"></div>
      <div class="sec-label">Who responded</div>
      <div class="sec-title">Respondent distribution: region vs. industry</div>
      <div class="card full" style="opacity:1;transform:none;">
        <div class="heatmap-wrap"><table class="heatmap" id="heatmap"></table></div>
        <div style="font-size:11px;color:var(--ink-faint);margin-top:10px;font-style:italic;">Cell color intensity shows concentration. This recalculates with your sidebar filters applied.</div>
      </div>
  
      <!-- FINDING 01: THE DOOM LOOP -->
      <div class="sec-divider"></div>
      <div class="sec-label">Finding 01 — Root Cause Analysis</div>
      <div class="sec-title">The doom loop: why some teams can never stop fighting fires</div>
      <div class="grid">
        <div class="card w2">
          <div class="card-hdr"><div class="card-label">Modeling Approach × Fire-Fighting Rate</div><div class="card-h">Fire-fighting rate by organizational factor</div><div class="card-sub">% of each group that includes "fighting fires" in their team focus</div></div>
          <div id="b-doom" class="hbar"></div>
          <div class="card-note"><b>How to read this:</b> Each bar shows the percentage of respondents in that group who listed "fighting fires" as part of their daily team focus. Ad-hoc modelers fight fires at nearly 2x the rate of teams with semantic models. Teams citing leadership as their bottleneck are also stuck. The pattern is clear: leadership gaps → ad-hoc practices → fire-fighting mode.</div>
        </div>
        <div class="card">
          <div class="card-hdr"><div class="card-label">Industry × Fire Rate</div><div class="card-h">Which industries burn the most</div><div class="card-sub">% with "fighting fires" in focus</div></div>
          <div id="b-ind-fire" class="hbar"></div>
        </div>
        <div class="card">
          <div class="card-hdr"><div class="card-label">Storage Platform × Fire Rate</div><div class="card-h">On-prem's hidden operational tax (Finding 05)</div><div class="card-sub">Fire-fighting rate by storage environment</div></div>
          <div id="b-stor-fire" class="hbar"></div>
          <div class="card-note"><b>This is Finding 05 in action:</b> On-prem warehouse teams fight fires at a meaningfully higher rate than cloud warehouse or lakehouse teams. This operational burden never appears in a vendor TCO comparison, but it's a real cost paid in engineer time and morale.</div>
        </div>
      </div>
  
      <!-- FINDING 02: THE AI PARADOX -->
      <div class="sec-divider"></div>
      <div class="sec-label">Finding 02 — The AI Paradox</div>
      <div class="sec-title">More AI adoption means more schema chaos — not less</div>
      <div class="grid">
        <div class="card w2">
          <div class="card-hdr"><div class="card-label">AI Adoption Level × Schema Pain</div><div class="card-h">Inconsistent schema pain by AI maturity tier</div><div class="card-sub">% of each AI adoption group reporting "AI tools produce inconsistent schemas" as a pain point</div></div>
          <div id="b-ai-schema" class="hbar"></div>
          <div class="card-note"><b>The paradox explained:</b> Teams at the highest AI adoption level report the most schema inconsistency pain. AI tools make it easy to generate transformations and pipelines quickly — but speed without modeling discipline just creates mess faster. AI amplifies whatever practices you already have.</div>
        </div>
        <div class="card">
          <div class="card-hdr"><div class="card-label">AI Adoption × All Modeling Pain Points</div><div class="card-h">Total modeling pain by AI maturity</div><div class="card-sub">% reporting at least one modeling pain point, by adoption level</div></div>
          <div id="b-ai-allpain" class="hbar"></div>
          <div class="card-note"><b>Broader view:</b> It's not just schema pain. Across all modeling pain points, the most AI-mature teams report equal or higher rates of modeling issues. AI isn't solving data modeling — it's making the consequences of bad modeling more visible, faster.</div>
        </div>
        <div class="card">
          <div class="card-hdr"><div class="card-label">Industry × AI Maturity</div><div class="card-h">Average AI maturity by industry</div><div class="card-sub">Scale: 0 (no adoption) to 4 (fully embedded)</div></div>
          <div id="b-ind-ai" class="hbar"></div>
          <div class="card-note"><b>Context:</b> Tech and Consulting lead AI adoption. Public sector and manufacturing lag behind. The industries furthest along with AI are also the ones most likely to feel the schema pain from Finding 02.</div>
        </div>
      </div>
  
      <!-- FINDING 03: ORG SIZE -->
      <div class="sec-divider"></div>
      <div class="sec-label">Finding 03 — Org Size Dynamics</div>
      <div class="sec-title">Your company size predicts your problems better than your tech stack</div>
      <div class="grid">
        <div class="card w2">
          <div class="card-hdr"><div class="card-label">Org Size × Biggest Bottleneck</div><div class="card-h">Small firms can't hire. Large firms can't lead.</div><div class="card-sub">Stacked bar: percentage of each org size bracket citing each bottleneck category</div></div>
          <div class="card-chart"><canvas id="c-org-bn"></canvas></div>
          <div class="card-note"><b>The shift is visible:</b> At &lt;50 employees, "Talent" is the tallest bar. At 200+, it's overtaken by "Leadership" and "Tech Debt." The problems you face depend more on how big your company is than what tools you use.</div>
        </div>
        <div class="card">
          <div class="card-hdr"><div class="card-label">Org Size × AI Maturity</div><div class="card-h">The mid-size AI stall</div><div class="card-sub">Average AI maturity score (0 to 4 scale), by org size</div></div>
          <div id="b-org-ai" class="hbar"></div>
          <div class="card-note"><b>The gap:</b> Small (&lt;50) and very large (10K+) organizations lead on AI maturity. Mid-size orgs (200–10K) show the lowest scores — they're too big to iterate fast like a startup, but too small to fund dedicated AI platform teams.</div>
        </div>
        <div class="card">
          <div class="card-hdr"><div class="card-label">Shrinking vs. Growing Teams</div><div class="card-h">What struggling data teams actually look like</div><div class="card-sub">Side-by-side comparison of the ~7% expecting to shrink vs. the ~40% expecting to grow</div></div>
          <table class="cmp" id="t-shrink"><thead><tr><th>Attribute</th><th>Shrinking</th><th>Growing</th></tr></thead><tbody></tbody></table>
          <div class="card-note"><b>Key takeaway:</b> Shrinking teams have more leadership gaps and less AI maturity. They aren't shrinking because AI replaced them. They're shrinking because they never got organizational buy-in in the first place.</div>
        </div>
      </div>
  
      <!-- FINDING 04: REGIONAL PATTERNS -->
      <div class="sec-divider"></div>
      <div class="sec-label">Finding 04 — Regional Patterns</div>
      <div class="sec-title">Every region's biggest problem is different</div>
      <div class="grid">
        <div class="card w2">
          <div class="card-hdr"><div class="card-label">Region × Biggest Bottleneck</div><div class="card-h">Every region's top two problems</div><div class="card-sub">This table recalculates with sidebar filters</div></div>
          <div style="overflow-x:auto;"><table class="cmp" id="t-regbn"><thead><tr><th>Region</th><th>Biggest bottleneck</th><th>Share</th><th>Runner-up</th><th>Share</th></tr></thead><tbody></tbody></table></div>
          <div class="card-note"><b>Why this matters:</b> If your company operates across regions, you can't apply the same data strategy everywhere. The US is fighting tech debt; Europe is fighting for leadership alignment; Asia-Pacific needs better requirements from upstream teams. Use the sidebar to filter by region and see how all the other charts shift too.</div>
        </div>
        <div class="card">
          <div class="card-hdr"><div class="card-label">Region × Education Demand</div><div class="card-h">What each region wants to learn next</div><div class="card-sub">Top training topics by region</div></div>
          <div class="card-chart"><canvas id="c-edu"></canvas></div>
          <div class="card-note"><b>One curriculum won't fit:</b> Asia-Pacific wants AI/LLM training. Middle East/Africa wants Data Modeling. US and Australia want Semantics. Regional training programs need to match regional gaps.</div>
        </div>
        <div class="card">
          <div class="card-hdr"><div class="card-label">Region × Team Shrinkage</div><div class="card-h">Which regions are losing data engineers</div><div class="card-sub">% of teams expecting headcount to shrink in 2026</div></div>
          <div id="b-shrink" class="hbar"></div>
          <div class="card-note"><b>Context:</b> Where shrinkage rates are highest, it correlates with leadership gaps — not with higher AI adoption. Teams aren't shrinking because AI replaced them. They're shrinking because leadership never invested in them.</div>
        </div>
      </div>
  
      <!-- BONUS: REGIONAL AI (supporting context, not a top-5 finding) -->
      <div class="sec-divider"></div>
      <div class="sec-label">Supporting Context</div>
      <div class="sec-title">How AI adoption varies across regions and industries</div>
      <div class="grid">
        <div class="card w2">
          <div class="card-hdr"><div class="card-label">Region × AI Adoption Level</div><div class="card-h">Regional AI maturity breakdown</div><div class="card-sub">Percentage at each adoption level, by region (note: some regions have small sample sizes)</div></div>
          <div class="card-chart"><canvas id="c-region-ai"></canvas></div>
          <div class="card-note"><b>A note on sample sizes:</b> US/Canada and Europe have 400+ respondents each. Other regions have 30–80. I included this chart for context, but be cautious about drawing strong conclusions from the smaller regions. The patterns in US/Canada and Europe are robust; the others are directional.</div>
        </div>
      </div>
  
    </div>
  </div>

    <!-- ORG SIZE -->
    <div class="sec-divider"></div>
    <div class="sec-label">Org Size Dynamics</div>
    <div class="sec-title">Your company size shapes your problems more than your tech stack</div>
    <div class="grid">
      <div class="card">
        <div class="card-hdr"><div class="card-label">Org Size x Bottleneck</div><div class="card-h">Small firms can't hire. Large firms can't lead.</div></div>
        <div class="card-chart"><canvas id="c-org-bn"></canvas></div>
      </div>
      <div class="card">
        <div class="card-hdr"><div class="card-label">Org Size x AI Maturity</div><div class="card-h">The mid-size AI stall</div><div class="card-sub">Average maturity (0 to 4 scale)</div></div>
        <div id="b-org-ai" class="hbar"></div>
        <div class="card-note">Small and large orgs lead AI adoption. Mid-size (200-10K) is stuck: too big to move fast, too small for dedicated AI teams.</div>
      </div>
      <div class="card">
        <div class="card-hdr"><div class="card-label">Shrinking vs Growing Teams</div><div class="card-h">What struggling data teams look like</div><div class="card-sub">Comparing the ~7% expecting to shrink</div></div>
        <table class="cmp" id="t-shrink"><thead><tr><th>Attribute</th><th>Shrinking</th><th>Growing</th></tr></thead><tbody></tbody></table>
        <div class="card-note">Shrinking teams have more leadership gaps and less AI maturity. They aren't shrinking because of AI. They're shrinking because they never got organizational buy-in.</div>
      </div>
    </div>

    </div>
  </div>

  <!-- CROSS-TAB PANE -->
  <div class="pane" id="p-xtab">
    <div class="xt-bar">
      <div class="xt-field"><label>Rows</label><select id="xt-r"></select></div>
      <span style="font-size:18px;color:var(--ink-faint);">&times;</span>
      <div class="xt-field"><label>Columns</label><select id="xt-c"></select></div>
      <div class="xt-field"><label>Values</label><div class="xt-radio"><label><input type="radio" name="xtm" value="count" checked> Count</label><label><input type="radio" name="xtm" value="row"> Row %</label><label><input type="radio" name="xtm" value="col"> Col %</label></div></div>
      <button class="xt-btn" onclick="runXT()">Generate</button>
    </div>
    <div class="xt-out" id="xt-out"><div class="xt-empty">Pick any two dimensions and click Generate. Sidebar filters apply here too.<br><br>Try: <b>Region x AI Adoption</b>, or <b>Industry x Biggest Bottleneck</b>, or <b>Org Size x Orchestration</b></div></div>
  </div>

  <!-- EXPLORER PANE -->
  <div class="pane" id="p-explore">
    <div class="ex-bar">
      <div class="xt-field"><label>Dimension</label><select id="ex-dim"></select></div>
      <div class="xt-field"><label>Chart Type</label><div class="ex-types">
        <button class="ex-type on" onclick="setExType('bar',this)">Bar</button>
        <button class="ex-type" onclick="setExType('hbar',this)">H-Bar</button>
        <button class="ex-type" onclick="setExType('pie',this)">Pie</button>
        <button class="ex-type" onclick="setExType('doughnut',this)">Donut</button>
      </div></div>
      <button class="xt-btn" onclick="renderEx()">Generate</button>
    </div>
    <div class="ex-chart"><canvas id="c-ex"></canvas></div>
    <div class="ex-tbl-wrap" id="ex-tbl"></div>
  </div>

  <!-- DATA PANE -->
  <div class="pane" id="p-data">
    <div class="data-info" id="data-info"></div>
    <div class="data-wrap" id="data-wrap"></div>
  </div>

  <div class="foot">
    <span>Analysis by <strong>Narendranath Edara</strong> · 2026 Practical Data Community Survey (n=1,101) · #PracticalDataSurvey Hackathon</span>
    <span><a href="https://joereis.github.io/practical_data_data_eng_survey/" target="_blank">Original Survey Explorer</a></span>
  </div>
</div>
</div>

<script>
let ALL=[],FD=[],CX={};
const DIMS=[
  {k:'region',l:'Region'},{k:'industry',l:'Industry'},{k:'org_size',l:'Org Size'},{k:'role',l:'Role'},
  {k:'ai_usage_frequency',l:'AI Frequency'},{k:'ai_adoption',l:'AI Adoption'},{k:'storage_environment',l:'Storage'},
  {k:'orchestration',l:'Orchestration'},{k:'modeling_approach',l:'Modeling Approach'},
  {k:'modeling_pain_points',l:'Modeling Pain Points'},{k:'architecture_trend',l:'Architecture Trend'},
  {k:'biggest_bottleneck',l:'Biggest Bottleneck'},{k:'team_growth_2026',l:'Team Growth 2026'},
  {k:'education_topic',l:'Education Topic'},{k:'team_focus',l:'Team Focus'},{k:'ai_helps_with',l:'AI Helps With'}
];
const AIM={'No meaningful adoption yet':0,'Experimenting':1,'Using AI for tactical tasks':2,'Building internal AI platforms':3,'AI embedded in most workflows':4};
const PAL=['#0f7b5f','#2563eb','#d4850e','#c0392b','#7c3aed','#0891b2','#ea580c','#be185d','#059669','#4f46e5','#dc2626','#0d9488','#9333ea','#e11d48'];
Chart.defaults.plugins.legend.labels.font = { size: 12, family: "'Outfit', sans-serif" };
Chart.defaults.plugins.legend.labels.padding = 12;
Chart.defaults.plugins.legend.labels.boxWidth = 12;
Chart.defaults.color='#9898b0';Chart.defaults.font.family="'Outfit',sans-serif";Chart.defaults.font.size=11;Chart.defaults.plugins.legend.display=false;

async function init(){
  const names=['survey_2026_data_engineering.csv','survey.csv'];let txt=null;
  for(const n of names){try{const r=await fetch(n);if(r.ok){txt=await r.text();break;}}catch(e){}}
  if(!txt){document.getElementById('loader').innerHTML='<p style="color:#c0392b">Could not load CSV. Place survey_2026_data_engineering.csv in the same folder.</p>';return;}
  ALL=Papa.parse(txt,{header:true,skipEmptyLines:true,transformHeader:h=>h.trim()}).data.filter(r=>r.role&&r.role.trim());
  FD=[...ALL];popFilters();popDimSelects();apply();
  document.getElementById('loader').classList.add('out');
  setTimeout(()=>document.getElementById('loader').style.display='none',500);
  observeCards();animateFindings();
}

function popFilters(){
  const m={'f-region':'region','f-industry':'industry','f-orgsize':'org_size','f-role':'role','f-ai':'ai_adoption','f-growth':'team_growth_2026'};
  for(const[id,f]of Object.entries(m)){
    const s=document.getElementById(id);while(s.options.length>1)s.remove(1);
    [...new Set(ALL.map(r=>r[f]).filter(Boolean))].sort().forEach(v=>{const o=document.createElement('option');o.value=v;o.textContent=v;s.appendChild(o);});
  }
}
function popDimSelects(){['xt-r','xt-c','ex-dim'].forEach(id=>{const s=document.getElementById(id);s.innerHTML='';DIMS.forEach(d=>{const o=document.createElement('option');o.value=d.k;o.textContent=d.l;s.appendChild(o);});});
  document.getElementById('xt-r').value='region';document.getElementById('xt-c').value='ai_adoption';document.getElementById('ex-dim').value='ai_adoption';
}

function apply(){
  const f={region:'f-region',industry:'f-industry',org_size:'f-orgsize',role:'f-role',ai_adoption:'f-ai',team_growth_2026:'f-growth'};
  FD=ALL.filter(r=>{for(const[field,id]of Object.entries(f)){const v=document.getElementById(id).value;if(v!=='all'&&r[field]!==v)return false;}return true;});
  document.getElementById('fc').textContent=FD.length;document.getElementById('ft').textContent=ALL.length;
  renderAll();renderDataTab();
}
function reset(){['f-region','f-industry','f-orgsize','f-role','f-ai','f-growth'].forEach(id=>document.getElementById(id).value='all');apply();}

function grp(d,f){const g={};d.forEach(r=>{const k=r[f]||'';if(k){if(!g[k])g[k]=[];g[k].push(r);}});return g;}
function pct(n,d){return d?(n/d*100):0;}
function avg(d,f,fn){let s=0,c=0;d.forEach(r=>{const v=fn(r[f]);if(v!=null&&!isNaN(v)){s+=v;c++;}});return c?s/c:0;}
function has(row,field,term){return row[field]&&row[field].includes(term);}
function catBn(s){if(!s)return'Other';const l=s.toLowerCase();if(l.includes('leadership'))return'Leadership';if(l.includes('legacy')||l.includes('tech debt'))return'Tech Debt';if(l.includes('requirement')||l.includes('upstream'))return'Requirements';if(l.includes('quality'))return'Data Quality';if(l.includes('talent')||l.includes('hiring')||l.includes('not enough'))return'Talent';if(l.includes('cost')||l.includes('budget'))return'Cost';if(l.includes('tool'))return'Tool Complexity';return'Other';}
function countF(d,f){const c={};d.forEach(r=>{const v=r[f];if(v&&v.trim())c[v]=(c[v]||0)+1;});return Object.fromEntries(Object.entries(c).sort((a,b)=>b[1]-a[1]));}
function countMF(d,f){const c={};d.forEach(r=>{if(!r[f])return;r[f].split(',').forEach(v=>{v=v.trim().replace(/"/g,'');if(v)c[v]=(c[v]||0)+1;});});return Object.fromEntries(Object.entries(c).sort((a,b)=>b[1]-a[1]));}

function mkChart(id,type,cfg){if(CX[id])CX[id].destroy();const cv=document.getElementById(id);if(!cv)return;CX[id]=new Chart(cv,{type,...cfg});return CX[id];}
function hbars(id,data,opts={}){
  const el=document.getElementById(id);if(!el)return;el.innerHTML='';
  const entries=Object.entries(data).sort((a,b)=>b[1]-a[1]);
  const mx=opts.max||Math.max(...entries.map(e=>e[1]))*1.15||1;
  const suf=opts.suf||'%';const dec=opts.dec??1;
  const cfn=opts.cfn||(()=>'var(--accent)');
  entries.forEach(([l,v],i)=>{
    const w=Math.max(0,Math.min(100,v/mx*100));
    const count=opts.counts?opts.counts[l]:'';
    const tip=count?`n=${count}`:`${v.toFixed(dec)}${suf}`;
    el.innerHTML+=`<div class="hrow"><div class="hrow-label" title="${l}">${l}</div><div class="hrow-track"><div class="hrow-fill" data-w="${w}" style="background:${cfn(l,v)}"></div><div class="hrow-tooltip">${l}: ${tip}</div></div><div class="hrow-val">${v.toFixed(dec)}${suf}</div></div>`;
  });
  // Animate bars
  requestAnimationFrame(()=>{
    el.querySelectorAll('.hrow-fill').forEach((bar,i)=>{
      setTimeout(()=>{bar.style.width=bar.dataset.w+'%';},i*40);
    });
  });
}
function ds(v,lo,hi){return v>=hi?'var(--red)':v>=lo?'var(--amber)':'var(--accent)';}

function mkDonut(id,val,color){
  const rest=100-val;
  mkChart(id,'doughnut',{
    data:{datasets:[{data:[val,rest],backgroundColor:[color,'#eae5de'],borderWidth:0,borderRadius:6}]},
    options:{responsive:true,cutout:'72%',plugins:{tooltip:{callbacks:{label:ctx=>ctx.dataIndex===0?val.toFixed(1)+'%':''}},legend:{display:false}},animation:{animateRotate:true,duration:1200,easing:'easeOutQuart'}}
  });
  document.getElementById(id+'v').textContent=val.toFixed(0)+'%';
}

function renderAll(){
  const d=FD,n=d.length;if(!n)return;

  mkDonut('d1',pct(d.filter(r=>has(r,'team_focus','Fighting fires')).length,n),'#c0392b');
  mkDonut('d2',pct(d.filter(r=>r.ai_usage_frequency==='Multiple times per day'||r.ai_usage_frequency==='Daily').length,n),'#0f7b5f');
  mkDonut('d3',pct(d.filter(r=>r.orchestration&&r.orchestration.toLowerCase().includes('no orchestration')).length,n),'#d4850e');
  mkDonut('d4',pct(d.filter(r=>r.team_growth_2026==='Grow').length,n),'#2563eb');
  mkDonut('d5',pct(d.filter(r=>r.modeling_pain_points&&!r.modeling_pain_points.includes('None / modeling is going well')).length,n),'#7c3aed');

  renderHeatmap();

  // Region AI chart
  const rg=grp(d,'region');const regs=Object.keys(rg).filter(r=>r!=='Prefer not to say'&&rg[r].length>=5).sort();
  const sr=regs.map(r=>r.replace('United States / Canada','US/CAN').replace('Europe (EU / UK)','Europe').replace('Asia\u2013Pacific','APAC').replace('Latin America','LATAM').replace('Middle East / Africa','MEA').replace('Australia / New Zealand','AUS/NZ'));
  mkChart('c-region-ai','bar',{
    data:{labels:sr,datasets:[
      {label:'AI Embedded',data:regs.map(r=>pct(rg[r].filter(x=>x.ai_adoption==='AI embedded in most workflows').length,rg[r].length)),backgroundColor:'#0f7b5f',borderRadius:3},
      {label:'Building Platforms',data:regs.map(r=>pct(rg[r].filter(x=>x.ai_adoption==='Building internal AI platforms').length,rg[r].length)),backgroundColor:'#7c3aed',borderRadius:3},
      {label:'Still Experimenting',data:regs.map(r=>pct(rg[r].filter(x=>x.ai_adoption==='Experimenting').length,rg[r].length)),backgroundColor:'#d4850e',borderRadius:3},
      {label:'No Adoption',data:regs.map(r=>pct(rg[r].filter(x=>x.ai_adoption==='No meaningful adoption yet').length,rg[r].length)),backgroundColor:'#c0392b',borderRadius:3}
    ]},
    options:{responsive:true,animation:{duration:800,easing:'easeOutQuart'},plugins:{legend:{display:true,position:'top',labels:{boxWidth:10,padding:14,font:{size:10}}}},scales:{x:{grid:{display:false}},y:{grid:{color:'#eae5de'},ticks:{callback:v=>v+'%'},beginAtZero:true}}}
  });

  const ig=grp(d,'industry');const iar={};
  for(const[k,rows]of Object.entries(ig)){if(rows.length>=5)iar[k.replace(' / Industrial','').replace('/e-commerce','').replace(' / Education','')]=avg(rows,'ai_adoption',v=>AIM[v]??null);}
  hbars('b-ind-ai',iar,{max:4,suf:'',dec:2,cfn:(l,v)=>ds(v,1.7,2.0)});

  const ag=grp(d,'ai_adoption');const ord=['Experimenting','Using AI for tactical tasks','No meaningful adoption yet','Building internal AI platforms','AI embedded in most workflows'];
  const slab={'Experimenting':'Experimenting','Using AI for tactical tasks':'Tactical Tasks','No meaningful adoption yet':'No Adoption','Building internal AI platforms':'Building Platforms','AI embedded in most workflows':'AI Embedded'};
  const asd={};ord.forEach(l=>{const rows=ag[l]||[];if(rows.length>5)asd[slab[l]]=pct(rows.filter(r=>has(r,'modeling_pain_points','AI tools produce inconsistent')).length,rows.length);});
  hbars('b-ai-schema',asd,{max:12,cfn:(l,v)=>ds(v,4,6)});

  const doom={};
  const calc=(label,subset)=>{if(subset.length>=8)doom[label]=pct(subset.filter(r=>has(r,'team_focus','Fighting fires')).length,subset.length);};
  calc('Ad-hoc modeling',d.filter(r=>r.modeling_approach==='Ad-hoc / tables added as needed'));
  calc('Leadership gap',d.filter(r=>r.biggest_bottleneck&&r.biggest_bottleneck.toLowerCase().includes('leadership')));
  calc('One Big Table',d.filter(r=>r.modeling_approach==='One Big Table'));
  calc('No orchestration',d.filter(r=>r.orchestration&&r.orchestration.toLowerCase().includes('no orchestration')));
  calc('Legacy / tech debt',d.filter(r=>r.biggest_bottleneck&&(r.biggest_bottleneck.toLowerCase().includes('legacy')||r.biggest_bottleneck.toLowerCase().includes('tech debt'))));
  calc('Kimball modeling',d.filter(r=>r.modeling_approach==='Kimball-style dimensional modeling'));
  calc('Mixed approach',d.filter(r=>r.modeling_approach==='Mixed (depends on use case)'));
  calc('Semantic models',d.filter(r=>r.modeling_approach==='Canonical/semantic models'));
  hbars('b-doom',doom,{max:48,cfn:(l,v)=>ds(v,25,32)});

  const ifr={};for(const[k,rows]of Object.entries(ig)){if(rows.length>=8)ifr[k.replace(' / Industrial','').replace('/e-commerce','').replace(' / Education','')]=pct(rows.filter(r=>has(r,'team_focus','Fighting fires')).length,rows.length);}
  hbars('b-ind-fire',ifr,{max:42,cfn:(l,v)=>ds(v,24,30)});

  const stMap={'Cloud data warehouse (Snowflake, BigQuery, Redshift, etc.)':'Cloud Warehouse','Lakehouse (Databricks, Iceberg/Hudi/Delta + compute engine)':'Lakehouse','Mixed/hybrid':'Mixed/Hybrid','On-prem data warehouse':'On-prem Warehouse','Cloud PostgreSQL/MySQL':'Cloud Postgres','On-prem data lake / lakehouse':'On-prem Lakehouse'};
  const sfr={};for(const[raw,label]of Object.entries(stMap)){const rows=d.filter(r=>r.storage_environment===raw);if(rows.length>=8)sfr[label]=pct(rows.filter(r=>has(r,'team_focus','Fighting fires')).length,rows.length);}
  hbars('b-stor-fire',sfr,{max:42,cfn:(l,v)=>ds(v,25,32)});

  renderRegBnTable();

  const topics=['AI/LLM integration','Architecture patterns','Data modeling','Semantics / ontologies / knowledge graphs','Reliability engineering','Streaming / event-driven systems'];
  const stpcs=['AI/LLM','Architecture','Modeling','Semantics','Reliability','Streaming'];
  const eregs=Object.keys(rg).filter(r=>r!=='Prefer not to say'&&rg[r].length>=10);
  const esr=eregs.map(r=>r.replace('United States / Canada','US').replace('Europe (EU / UK)','EU').replace('Asia\u2013Pacific','APAC').replace('Latin America','LATAM').replace('Middle East / Africa','MEA').replace('Australia / New Zealand','AUS'));
  mkChart('c-edu','bar',{
    data:{labels:stpcs,datasets:esr.map((s,i)=>({
      label:s,data:topics.map(t=>pct(rg[eregs[i]].filter(r=>r.education_topic===t).length,rg[eregs[i]].length)),
      backgroundColor:PAL[i]+'aa',borderColor:PAL[i],borderWidth:1,borderRadius:3
    }))},
    options:{responsive:true,animation:{duration:800},plugins:{legend:{display:true,position:'top',labels:{boxWidth:8,padding:10,font:{size:9}}}},scales:{x:{grid:{display:false},ticks:{font:{size:10}}},y:{grid:{color:'#eae5de'},ticks:{callback:v=>v+'%'},beginAtZero:true}}}
  });

  const shk={};Object.entries(rg).filter(([k])=>k!=='Prefer not to say').forEach(([r,rows])=>{if(rows.length>=10)shk[r.replace('United States / Canada','US/Canada').replace('Europe (EU / UK)','Europe').replace('Asia\u2013Pacific','APAC').replace('Latin America','LATAM').replace('Middle East / Africa','MEA').replace('Australia / New Zealand','AUS/NZ')]=pct(rows.filter(x=>x.team_growth_2026==='Shrink').length,rows.length);});
  hbars('b-shrink',shk,{max:16,cfn:(l,v)=>ds(v,7,10)});

  const sizes=['< 50 employees','50\u2013199','200\u2013999','1,000\u201310,000','10,000+'];
  const ssizes=['<50','50-199','200-999','1K-10K','10K+'];
  const og=grp(d,'org_size');
  const bcats=['Talent','Leadership','Tech Debt','Requirements','Data Quality'];
  const bcols=['#be185d','#c0392b','#d4850e','#7c3aed','#0891b2'];
  mkChart('c-org-bn','bar',{
    data:{labels:ssizes,datasets:bcats.map((cat,i)=>({
      label:cat,data:sizes.map(s=>{const rows=og[s]||[];return pct(rows.filter(r=>catBn(r.biggest_bottleneck)===cat).length,rows.length);}),
      backgroundColor:bcols[i]+'cc',borderRadius:2,borderSkipped:false
    }))},
    options:{responsive:true,animation:{duration:800},plugins:{legend:{display:true,position:'top',labels:{boxWidth:8,padding:10,font:{size:9}}}},scales:{x:{stacked:true,grid:{display:false}},y:{stacked:true,grid:{color:'#eae5de'},ticks:{callback:v=>v+'%'}}}}
  });

  const oai={};sizes.forEach((s,i)=>{const rows=og[s]||[];if(rows.length>=5)oai[ssizes[i]]=avg(rows,'ai_adoption',v=>AIM[v]??null);});
  hbars('b-org-ai',oai,{max:4,suf:'',dec:2,cfn:(l,v)=>ds(v,1.8,1.9)});

  renderShrinkTable();
}

function renderHeatmap(){
  const tbl=document.getElementById('heatmap');
  const rg=grp(FD,'region');
  const regions=Object.keys(rg).filter(r=>r!=='Prefer not to say').sort();
  const industries=[...new Set(FD.map(r=>r.industry).filter(Boolean))].sort();
  const short={'United States / Canada':'US/Canada','Europe (EU / UK)':'Europe','Asia\u2013Pacific':'APAC','Latin America':'LATAM','Middle East / Africa':'MEA','Australia / New Zealand':'AUS/NZ'};
  const shortInd=i=>i.replace(' / Industrial','').replace('/e-commerce','').replace(' / Education','');
  const mx={};let maxV=0;
  regions.forEach(r=>{mx[r]={};industries.forEach(ind=>{const c=FD.filter(x=>x.region===r&&x.industry===ind).length;mx[r][ind]=c;if(c>maxV)maxV=c;});});
  let h='<thead><tr><th></th>';industries.forEach(i=>h+=`<th>${shortInd(i)}</th>`);h+='<th>Total</th></tr></thead><tbody>';
  regions.forEach(r=>{
    h+=`<tr><td>${short[r]||r}</td>`;let rowT=0;
    industries.forEach(ind=>{
      const v=mx[r][ind];rowT+=v;
      const intensity=maxV?v/maxV:0;
      const bg=intensity>0.5?`rgba(15,123,95,${0.1+intensity*0.4})`:(intensity>0.15?`rgba(15,123,95,${intensity*0.35})`:'transparent');
      const fw=intensity>0.3?'600':'400';const col=intensity>0.5?'#0f7b5f':'inherit';
      h+=`<td><span class="heat-cell" style="background:${bg};font-weight:${fw};color:${col}">${v}</span></td>`;
    });h+=`<td style="font-weight:600;">${rowT}</td></tr>`;
  });
  h+='<tr style="font-weight:600;"><td>Total</td>';
  industries.forEach(ind=>{let t=0;regions.forEach(r=>t+=mx[r][ind]);h+=`<td>${t}</td>`;});
  h+=`<td style="color:var(--accent);font-weight:700;">${FD.length}</td></tr></tbody>`;tbl.innerHTML=h;
}

function renderRegBnTable(){
  const rg=grp(FD,'region');const tbody=document.querySelector('#t-regbn tbody');tbody.innerHTML='';
  Object.entries(rg).filter(([k])=>k!=='Prefer not to say').sort((a,b)=>b[1].length-a[1].length).forEach(([region,rows])=>{
    const cats={};rows.forEach(r=>{const c=catBn(r.biggest_bottleneck);cats[c]=(cats[c]||0)+1;});
    const sorted=Object.entries(cats).sort((a,b)=>b[1]-a[1]);
    const t=sorted[0]||['\u2014',0],s=sorted[1]||['\u2014',0];
    tbody.innerHTML+=`<tr><td>${region}</td><td class="good">${t[0]}</td><td class="good">${pct(t[1],rows.length).toFixed(1)}%</td><td>${s[0]}</td><td>${pct(s[1],rows.length).toFixed(1)}%</td></tr>`;
  });
}

function renderShrinkTable(){
  const sh=FD.filter(r=>r.team_growth_2026==='Shrink'),gr=FD.filter(r=>r.team_growth_2026==='Grow');
  const tbody=document.querySelector('#t-shrink tbody');tbody.innerHTML='';
  if(sh.length<3||gr.length<3){tbody.innerHTML='<tr><td colspan="3" style="text-align:center;color:var(--ink-faint)">Not enough data for this filter</td></tr>';return;}
  const metrics=[
    ['Leadership bottleneck',r=>r.biggest_bottleneck&&r.biggest_bottleneck.toLowerCase().includes('leadership')],
    ['AI embedded in workflows',r=>r.ai_adoption==='AI embedded in most workflows'],
    ['No AI adoption',r=>r.ai_adoption==='No meaningful adoption yet'],
    ['Fighting fires',r=>has(r,'team_focus','Fighting fires')],
    ['No orchestration',r=>r.orchestration&&r.orchestration.toLowerCase().includes('no orchestration')],
    ['Talent bottleneck',r=>r.biggest_bottleneck&&(r.biggest_bottleneck.toLowerCase().includes('talent')||r.biggest_bottleneck.toLowerCase().includes('hiring'))]
  ];
  metrics.forEach(([label,fn])=>{
    const sv=pct(sh.filter(fn).length,sh.length).toFixed(1),gv=pct(gr.filter(fn).length,gr.length).toFixed(1);
    const sc=parseFloat(sv)>parseFloat(gv)+3?'bad':'',gc=parseFloat(gv)>parseFloat(sv)+3?'good':'';
    tbody.innerHTML+=`<tr><td>${label}</td><td class="${sc}">${sv}%</td><td class="${gc}">${gv}%</td></tr>`;
  });
}

// CROSS-TAB
function runXT(){
  const rf=document.getElementById('xt-r').value,cf=document.getElementById('xt-c').value;
  const metric=document.querySelector('input[name="xtm"]:checked').value;
  const out=document.getElementById('xt-out');
  const rvals=[...new Set(FD.map(r=>r[rf]).filter(Boolean))].sort();
  const cvals=[...new Set(FD.map(r=>r[cf]).filter(Boolean))].sort();
  const mx={},rt={},ct={};let grand=0;
  rvals.forEach(r=>{mx[r]={};rt[r]=0;cvals.forEach(c=>mx[r][c]=0);});cvals.forEach(c=>ct[c]=0);
  FD.forEach(r=>{const rv=r[rf],cv=r[cf];if(rv&&cv&&mx[rv]){mx[rv][cv]++;rt[rv]++;ct[cv]=(ct[cv]||0)+1;grand++;}});
  let allV=[];rvals.forEach(r=>cvals.forEach(c=>{let v=mx[r][c];if(metric==='row')v=rt[r]?v/rt[r]*100:0;if(metric==='col')v=ct[c]?v/ct[c]*100:0;allV.push(v);}));
  const maxV=Math.max(...allV)||1;
  let h=`<table class="xt-tbl"><thead><tr><th>${DIMS.find(d=>d.k===rf)?.l||rf} / ${DIMS.find(d=>d.k===cf)?.l||cf}</th>`;
  cvals.forEach(c=>h+=`<th>${c}</th>`);h+='<th>Total</th></tr></thead><tbody>';
  rvals.forEach(rv=>{
    h+='<tr><td>'+rv+'</td>';
    cvals.forEach(cv=>{
      let v=mx[rv][cv],disp=v;
      if(metric==='row'){v=rt[rv]?v/rt[rv]*100:0;disp=v.toFixed(1)+'%';}
      else if(metric==='col'){v=ct[cv]?v/ct[cv]*100:0;disp=v.toFixed(1)+'%';}
      const ratio=v/maxV;let cls='';if(ratio>.65)cls='xt-hi';else if(ratio>.35)cls='xt-mid';
      h+=`<td class="${cls}">${disp}</td>`;
    });h+=`<td style="font-weight:600">${rt[rv]}</td></tr>`;
  });
  h+='<tr style="font-weight:600"><td>Total</td>';cvals.forEach(c=>h+=`<td>${ct[c]||0}</td>`);
  h+=`<td>${grand}</td></tr></tbody></table>`;out.innerHTML=h;
}

// EXPLORER
let exType='bar';
function setExType(t,btn){exType=t;document.querySelectorAll('.ex-type').forEach(b=>b.classList.remove('on'));btn.classList.add('on');}
function renderEx(){
  const dim=document.getElementById('ex-dim').value;
  const multi=['team_focus','ai_helps_with','modeling_pain_points'];
  const data=multi.includes(dim)?countMF(FD,dim):countF(FD,dim);
  const entries=Object.entries(data).slice(0,15);const labels=entries.map(e=>e[0]),vals=entries.map(e=>e[1]);
  const type=exType==='hbar'?'bar':exType;const isH=exType==='hbar';const isPie=['pie','doughnut'].includes(type);
  mkChart('c-ex',type,{
    data:{labels,datasets:[{data:vals,backgroundColor:isPie?PAL.slice(0,labels.length):'rgba(15,123,95,0.7)',borderColor:isPie?'#fff':'rgba(15,123,95,1)',borderWidth:isPie?2:0,borderRadius:isPie?0:4}]},
    options:{responsive:true,indexAxis:isH?'y':'x',animation:{duration:800,easing:'easeOutQuart'},plugins:{legend:{display:isPie,position:'right',labels:{boxWidth:12,font:{size:13},padding:12}},tooltip:{padding:10}},
      scales:isPie?{}:{x:{grid:{color:isH?'#eae5de':false},ticks:{maxRotation:45}},y:{grid:{color:isH?false:'#eae5de'},beginAtZero:true}}
    }
  });
  const total=vals.reduce((a,b)=>a+b,0);let t='<table class="cmp"><thead><tr><th>Value</th><th>Count</th><th>Percent</th></tr></thead><tbody>';
  entries.forEach(([l,v])=>t+=`<tr><td>${l}</td><td>${v}</td><td>${(v/total*100).toFixed(1)}%</td></tr>`);
  t+='</tbody></table>';document.getElementById('ex-tbl').innerHTML=t;
}

// DATA BROWSER
let sortC=null,sortD=1;
function renderDataTab(){
  const cols=['role','org_size','industry','region','ai_usage_frequency','ai_adoption','storage_environment','orchestration','modeling_approach','biggest_bottleneck','team_growth_2026','education_topic'];
  let data=[...FD];
  if(sortC)data.sort((a,b)=>{const av=(a[sortC]||'').toLowerCase(),bv=(b[sortC]||'').toLowerCase();return av<bv?-sortD:av>bv?sortD:0;});
  const show=data.slice(0,200);
  let h='<table><thead><tr>';cols.forEach(c=>{const ar=sortC===c?(sortD===1?' \u25B2':' \u25BC'):'';h+=`<th onclick="sortD_('${c}')">${c.replace(/_/g,' ')}${ar}</th>`;});
  h+='</tr></thead><tbody>';show.forEach(r=>{h+='<tr>';cols.forEach(c=>h+=`<td title="${(r[c]||'').replace(/"/g,'&quot;')}">${r[c]||''}</td>`);h+='</tr>';});
  h+='</tbody></table>';document.getElementById('data-wrap').innerHTML=h;
  document.getElementById('data-info').textContent=`Showing ${Math.min(200,FD.length)} of ${FD.length} filtered rows. Click column headers to sort.`;
}
function sortD_(c){if(sortC===c)sortD*=-1;else{sortC=c;sortD=1;}renderDataTab();}

// TABS
function switchTab(id,btn){
  document.querySelectorAll('.pane').forEach(p=>p.classList.remove('on'));
  document.querySelectorAll('.tab').forEach(b=>b.classList.remove('on'));
  document.getElementById('p-'+id).classList.add('on');btn.classList.add('on');
}

// ANIMATIONS
function observeCards(){
  const obs=new IntersectionObserver((entries)=>{entries.forEach((e,i)=>{if(e.isIntersecting){setTimeout(()=>e.target.classList.add('vis'),i*80);obs.unobserve(e.target);}});},{threshold:0.08,rootMargin:'0px 0px -30px 0px'});
  document.querySelectorAll('.card:not(.full)').forEach(c=>obs.observe(c));
}
function animateFindings(){
  const findings=document.querySelectorAll('.finding');
  const obs=new IntersectionObserver((entries)=>{entries.forEach(e=>{if(e.isIntersecting){setTimeout(()=>e.target.classList.add('visible'),parseInt(e.target.dataset.delay)||0);obs.unobserve(e.target);}});},{threshold:0.2});
  findings.forEach(f=>obs.observe(f));
}

init();
</script>
</body>
</html>
