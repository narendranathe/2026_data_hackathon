<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hidden Patterns: 2026 Data Engineering Survey ‚Äî Deep Insights Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
<style>
  :root {
    --bg: #0f172a;
    --surface: #1e293b;
    --surface2: #334155;
    --border: #475569;
    --text: #e2e8f0;
    --text-dim: #94a3b8;
    --accent: #38bdf8;
    --accent2: #818cf8;
    --accent3: #34d399;
    --accent4: #fb923c;
    --accent5: #f472b6;
    --danger: #ef4444;
    --warning: #eab308;
    --success: #22c55e;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.6;
    overflow-x: hidden;
  }

  /* Header */
  .hero {
    background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #0f172a 100%);
    padding: 48px 24px 36px;
    text-align: center;
    border-bottom: 1px solid var(--border);
    position: relative;
    overflow: hidden;
  }

  .hero::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: radial-gradient(ellipse at 50% 0%, rgba(56,189,248,0.1) 0%, transparent 70%);
    pointer-events: none;
  }

  .hero h1 {
    font-size: clamp(28px, 4vw, 44px);
    font-weight: 800;
    background: linear-gradient(135deg, #38bdf8, #818cf8, #c084fc);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 8px;
    position: relative;
  }

  .hero .subtitle {
    font-size: clamp(14px, 2vw, 18px);
    color: var(--text-dim);
    max-width: 700px;
    margin: 0 auto 16px;
  }

  .hero .meta {
    font-size: 12px;
    color: var(--text-dim);
    opacity: 0.7;
  }

  .hero .tag {
    display: inline-block;
    background: rgba(56,189,248,0.15);
    color: var(--accent);
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    margin: 4px;
    border: 1px solid rgba(56,189,248,0.3);
  }

  /* Navigation */
  .nav-bar {
    background: var(--surface);
    border-bottom: 1px solid var(--border);
    padding: 0 24px;
    display: flex;
    gap: 0;
    overflow-x: auto;
    position: sticky;
    top: 0;
    z-index: 100;
  }

  .nav-btn {
    padding: 12px 20px;
    background: none;
    border: none;
    color: var(--text-dim);
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    white-space: nowrap;
    border-bottom: 2px solid transparent;
    transition: all 0.2s;
    font-family: inherit;
  }

  .nav-btn:hover { color: var(--text); background: rgba(255,255,255,0.03); }
  .nav-btn.active { color: var(--accent); border-bottom-color: var(--accent); }

  /* Sections */
  .section {
    display: none;
    padding: 24px;
    max-width: 1400px;
    margin: 0 auto;
  }

  .section.active { display: block; }

  .section-title {
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 4px;
    color: var(--text);
  }

  .section-desc {
    font-size: 14px;
    color: var(--text-dim);
    margin-bottom: 24px;
    max-width: 800px;
  }

  /* Cards */
  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
  }

  .card-title {
    font-size: 16px;
    font-weight: 700;
    margin-bottom: 4px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .card-subtitle {
    font-size: 12px;
    color: var(--text-dim);
    margin-bottom: 16px;
  }

  /* Grid layouts */
  .grid-2 { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; }
  .grid-3 { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
  .grid-4 { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 16px; }

  /* KPI cards */
  .kpi-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    text-align: center;
    position: relative;
    overflow: hidden;
  }

  .kpi-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
  }

  .kpi-card.blue::before { background: var(--accent); }
  .kpi-card.purple::before { background: var(--accent2); }
  .kpi-card.green::before { background: var(--accent3); }
  .kpi-card.orange::before { background: var(--accent4); }
  .kpi-card.pink::before { background: var(--accent5); }
  .kpi-card.red::before { background: var(--danger); }

  .kpi-value {
    font-size: 36px;
    font-weight: 800;
    line-height: 1.1;
  }

  .kpi-value.blue { color: var(--accent); }
  .kpi-value.purple { color: var(--accent2); }
  .kpi-value.green { color: var(--accent3); }
  .kpi-value.orange { color: var(--accent4); }
  .kpi-value.pink { color: var(--accent5); }
  .kpi-value.red { color: var(--danger); }

  .kpi-label {
    font-size: 12px;
    color: var(--text-dim);
    text-transform: uppercase;
    font-weight: 600;
    letter-spacing: 0.5px;
    margin-top: 4px;
  }

  .kpi-detail {
    font-size: 11px;
    color: var(--text-dim);
    margin-top: 8px;
    opacity: 0.7;
  }

  /* Insight callout */
  .insight-box {
    background: linear-gradient(135deg, rgba(56,189,248,0.08), rgba(129,140,248,0.08));
    border: 1px solid rgba(56,189,248,0.2);
    border-radius: 10px;
    padding: 16px 20px;
    margin: 16px 0;
    font-size: 14px;
    line-height: 1.7;
  }

  .insight-box .insight-label {
    font-weight: 700;
    color: var(--accent);
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 6px;
  }

  .insight-box.warning {
    background: linear-gradient(135deg, rgba(234,179,8,0.08), rgba(251,146,60,0.08));
    border-color: rgba(234,179,8,0.2);
  }

  .insight-box.warning .insight-label { color: var(--warning); }

  .insight-box.danger {
    background: linear-gradient(135deg, rgba(239,68,68,0.08), rgba(244,114,182,0.08));
    border-color: rgba(239,68,68,0.2);
  }

  .insight-box.danger .insight-label { color: var(--danger); }

  .insight-box.success {
    background: linear-gradient(135deg, rgba(34,197,94,0.08), rgba(52,211,153,0.08));
    border-color: rgba(34,197,94,0.2);
  }

  .insight-box.success .insight-label { color: var(--success); }

  /* Chart containers */
  .chart-container {
    position: relative;
    width: 100%;
    max-height: 400px;
  }

  .chart-container canvas {
    max-width: 100%;
    max-height: 400px;
  }

  .chart-container-tall {
    max-height: 500px;
  }

  .chart-container-tall canvas {
    max-height: 500px;
  }

  /* Tables */
  .data-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 13px;
  }

  .data-table th {
    background: var(--surface2);
    padding: 10px 12px;
    text-align: left;
    font-weight: 600;
    color: var(--text-dim);
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border-bottom: 1px solid var(--border);
    position: sticky;
    top: 0;
  }

  .data-table td {
    padding: 8px 12px;
    border-bottom: 1px solid rgba(71,85,105,0.3);
  }

  .data-table tr:hover td {
    background: rgba(56,189,248,0.05);
  }

  .bar-cell {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .bar-fill {
    height: 8px;
    border-radius: 4px;
    background: var(--accent);
    transition: width 0.5s;
  }

  /* Heatmap */
  .heatmap-container {
    overflow-x: auto;
  }

  .heatmap-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 11px;
  }

  .heatmap-table th {
    padding: 8px 6px;
    font-weight: 600;
    color: var(--text-dim);
    font-size: 10px;
    text-transform: uppercase;
    white-space: nowrap;
  }

  .heatmap-table td {
    padding: 6px 8px;
    text-align: center;
    font-weight: 600;
    font-size: 12px;
    border: 1px solid rgba(71,85,105,0.2);
    min-width: 50px;
  }

  .heatmap-table td:first-child {
    text-align: left;
    font-weight: 500;
    background: var(--surface2);
    white-space: nowrap;
    min-width: 120px;
  }

  /* Filter bar */
  .filter-bar {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    margin-bottom: 20px;
    align-items: center;
  }

  .filter-bar label {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-dim);
    text-transform: uppercase;
  }

  .filter-bar select {
    background: var(--surface2);
    color: var(--text);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 8px 12px;
    font-size: 13px;
    font-family: inherit;
    cursor: pointer;
  }

  .filter-bar select:focus {
    outline: none;
    border-color: var(--accent);
  }

  /* Scrollable table wrapper */
  .table-scroll {
    max-height: 400px;
    overflow-y: auto;
    border: 1px solid var(--border);
    border-radius: 8px;
  }

  .table-scroll::-webkit-scrollbar { width: 6px; }
  .table-scroll::-webkit-scrollbar-track { background: var(--surface); }
  .table-scroll::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

  /* Word cloud proxy - tag cloud */
  .tag-cloud {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    justify-content: center;
    padding: 16px;
  }

  .tag-cloud .theme-tag {
    padding: 6px 14px;
    border-radius: 20px;
    font-weight: 600;
    border: 1px solid;
    white-space: nowrap;
  }

  /* Loading */
  .loading {
    text-align: center;
    padding: 60px;
    color: var(--text-dim);
    font-size: 16px;
  }

  .loading .spinner {
    display: inline-block;
    width: 40px;
    height: 40px;
    border: 3px solid var(--border);
    border-top-color: var(--accent);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    margin-bottom: 16px;
  }

  @keyframes spin { to { transform: rotate(360deg); } }

  /* Responsive */
  @media (max-width: 768px) {
    .grid-2, .grid-3, .grid-4 {
      grid-template-columns: 1fr;
    }
    .nav-bar { padding: 0 8px; }
    .nav-btn { padding: 10px 14px; font-size: 12px; }
    .section { padding: 16px; }
  }

  /* Print */
  @media print {
    .nav-bar { display: none; }
    .section { display: block !important; page-break-inside: avoid; }
    body { background: white; color: #000; }
    .card { border: 1px solid #ccc; }
  }

  .footer {
    text-align: center;
    padding: 40px 24px;
    color: var(--text-dim);
    font-size: 12px;
    border-top: 1px solid var(--border);
    margin-top: 40px;
  }

  .footer a { color: var(--accent); text-decoration: none; }
  .footer a:hover { text-decoration: underline; }

  .comparison-row {
    display: flex;
    gap: 20px;
    margin-bottom: 12px;
  }

  .comparison-item {
    flex: 1;
    background: var(--surface2);
    border-radius: 8px;
    padding: 12px 16px;
    text-align: center;
  }

  .comparison-item .comp-value {
    font-size: 28px;
    font-weight: 800;
  }

  .comparison-item .comp-label {
    font-size: 11px;
    color: var(--text-dim);
    margin-top: 4px;
  }

  .vs-badge {
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 700;
    color: var(--accent4);
    min-width: 30px;
  }
</style>
</head>
<body>

<div class="hero">
  <h1>üîç Hidden Patterns</h1>
  <div class="subtitle">
    Insights the original report didn't surface ‚Äî from 1,101 data professionals worldwide.
    Cross-correlations, regional divides, maturity gaps, and the real story behind AI adoption.
  </div>
  <div>
    <span class="tag">#PracticalDataSurvey</span>
    <span class="tag">n = 1,101</span>
    <span class="tag">18 Dimensions</span>
  </div>
  <div class="meta" style="margin-top:12px">
    2026 State of Data Engineering Survey ‚Äî Deep Analysis Dashboard
  </div>
</div>

<div class="nav-bar">
  <button class="nav-btn active" onclick="showSection('overview', this)">üìä Key Findings</button>
  <button class="nav-btn" onclick="showSection('ai-deep', this)">ü§ñ AI Reality Check</button>
  <button class="nav-btn" onclick="showSection('regional', this)">üåç Regional Divides</button>
  <button class="nav-btn" onclick="showSection('maturity', this)">üèóÔ∏è Org Maturity</button>
  <button class="nav-btn" onclick="showSection('pain', this)">üò∞ Root Causes</button>
  <button class="nav-btn" onclick="showSection('voices', this)">üí¨ Voices</button>
  <button class="nav-btn" onclick="showSection('crosstab', this)">üî¨ Explorer</button>
</div>

<div id="loading-screen" class="loading">
  <div class="spinner"></div>
  <div>Parsing 1,101 survey responses...</div>
</div>

<!-- SECTION: Key Findings -->
<div class="section active" id="sec-overview" style="display:none">
  <h2 class="section-title">üìä Six Findings That Change the Narrative</h2>
  <p class="section-desc">
    The original report showed distributions. This dashboard reveals the <em>relationships</em> between them ‚Äî and what they mean for the industry.
  </p>

  <div class="grid-4" id="kpi-grid"></div>

  <div class="insight-box">
    <div class="insight-label">üí° The Headline Insight</div>
    <strong>AI usage is nearly universal, but organizational adoption is shallow.</strong>
    The majority of data professionals use AI daily ‚Äî yet most organizations are still only "experimenting."
    This gap between individual and organizational adoption is the defining tension of 2026.
  </div>

  <div class="grid-2">
    <div class="card">
      <div class="card-title">üìà The AI Paradox: Personal vs. Organizational</div>
      <div class="card-subtitle">Individual AI usage frequency vs. organizational AI adoption maturity</div>
      <div class="chart-container"><canvas id="chart-ai-paradox"></canvas></div>
    </div>
    <div class="card">
      <div class="card-title">üîó Growth Optimism by AI Maturity</div>
      <div class="card-subtitle">Do AI-mature orgs expect team growth? The answer may surprise you.</div>
      <div class="chart-container"><canvas id="chart-growth-ai"></canvas></div>
    </div>
  </div>

  <div class="card">
    <div class="card-title">üè¢ The "No Orchestration" Problem by Org Size</div>
    <div class="card-subtitle">What percentage of orgs at each size have no orchestration at all?</div>
    <div class="chart-container"><canvas id="chart-orch-orgsize"></canvas></div>
    <div class="insight-box warning" style="margin-top:12px">
      <div class="insight-label">‚ö†Ô∏è Surprising Finding</div>
      Even among organizations with 10,000+ employees, a notable share still runs data pipelines without any orchestration tool. 
      This isn't a "small company" problem ‚Äî it's an industry-wide gap.
    </div>
  </div>
</div>

<!-- SECTION: AI Deep Dive -->
<div class="section" id="sec-ai-deep">
  <h2 class="section-title">ü§ñ The AI Reality Check</h2>
  <p class="section-desc">
    Everyone says they're "using AI." But what does that actually mean?
    We cross-referenced AI usage patterns with what AI helps with, organizational adoption stage, and pain points.
  </p>

  <div class="grid-2">
    <div class="card">
      <div class="card-title">What AI Actually Helps With</div>
      <div class="card-subtitle">Across all respondents who use AI ‚Äî what tasks does it assist?</div>
      <div class="chart-container chart-container-tall"><canvas id="chart-ai-helps"></canvas></div>
    </div>
    <div class="card">
      <div class="card-title">AI Adoption Stage by Org Size</div>
      <div class="card-subtitle">Larger orgs aren't necessarily more AI-mature</div>
      <div class="chart-container"><canvas id="chart-ai-orgsize"></canvas></div>
    </div>
  </div>

  <div class="card">
    <div class="card-title">üî¨ The "AI Doesn't Help" Cohort</div>
    <div class="card-subtitle">Who explicitly says AI is NOT helpful? What do they have in common?</div>
    <div id="ai-not-helpful-analysis"></div>
  </div>

  <div class="card">
    <div class="card-title">Daily AI Users: What's Different About Them?</div>
    <div class="card-subtitle">Comparing daily AI users to rare/never users across key dimensions</div>
    <div id="daily-vs-rare"></div>
  </div>
</div>

<!-- SECTION: Regional Divides -->
<div class="section" id="sec-regional">
  <h2 class="section-title">üåç Regional Divides</h2>
  <p class="section-desc">
    The data engineering world is not monolithic. Regions show starkly different patterns in tooling, AI adoption, pain points, and growth expectations.
  </p>

  <div class="card">
    <div class="card-title">Regional Response Distribution</div>
    <div class="card-subtitle">Where did the 1,101 responses come from?</div>
    <div class="grid-2">
      <div class="chart-container"><canvas id="chart-region-dist"></canvas></div>
      <div id="region-kpis"></div>
    </div>
  </div>

  <div class="card">
    <div class="card-title">üî• Regional Heatmap: Key Metrics Compared</div>
    <div class="card-subtitle">How do regions differ on AI usage, growth optimism, orchestration maturity, and pain?</div>
    <div class="heatmap-container" id="regional-heatmap"></div>
  </div>

  <div class="grid-2">
    <div class="card">
      <div class="card-title">Modeling Approach by Region</div>
      <div class="card-subtitle">Does modeling philosophy vary geographically?</div>
      <div class="chart-container"><canvas id="chart-model-region"></canvas></div>
    </div>
    <div class="card">
      <div class="card-title">Architecture Trend by Region</div>
      <div class="card-subtitle">Lakehouse vs. warehouse preferences across the globe</div>
      <div class="chart-container"><canvas id="chart-arch-region"></canvas></div>
    </div>
  </div>
</div>

<!-- SECTION: Org Maturity -->
<div class="section" id="sec-maturity">
  <h2 class="section-title">üèóÔ∏è Organizational Maturity Segmentation</h2>
  <p class="section-desc">
    We created a composite "maturity score" from orchestration usage, modeling approach, AI adoption, and storage environment. The results reveal three distinct tiers.
  </p>

  <div class="card">
    <div class="card-title">Maturity Score Distribution</div>
    <div class="card-subtitle">Score = f(has orchestration, uses intentional modeling, cloud-native storage, AI adoption beyond experimenting)</div>
    <div class="grid-3" id="maturity-tiers"></div>
  </div>

  <div class="grid-2">
    <div class="card">
      <div class="card-title">Maturity Tier vs. Growth Expectations</div>
      <div class="card-subtitle">Do more mature orgs expect to grow their teams?</div>
      <div class="chart-container"><canvas id="chart-maturity-growth"></canvas></div>
    </div>
    <div class="card">
      <div class="card-title">Maturity Tier vs. Biggest Bottleneck</div>
      <div class="card-subtitle">Different maturity levels face different bottlenecks</div>
      <div class="chart-container"><canvas id="chart-maturity-bottleneck"></canvas></div>
    </div>
  </div>

  <div class="card">
    <div class="card-title">Maturity by Org Size</div>
    <div class="card-subtitle">Are bigger companies more mature? Not always.</div>
    <div class="chart-container"><canvas id="chart-maturity-orgsize"></canvas></div>
  </div>
</div>

<!-- SECTION: Root Causes -->
<div class="section" id="sec-pain">
  <h2 class="section-title">üò∞ Root Cause Analysis: Why Is Everything So Hard?</h2>
  <p class="section-desc">
    89% of respondents report modeling pain. But what's <em>driving</em> that pain? We connected pain points to org characteristics to find the root causes.
  </p>

  <div class="grid-2">
    <div class="card">
      <div class="card-title">"Pressure to Move Fast" ‚Äî Who Feels It Most?</div>
      <div class="card-subtitle">Breakdown by role of who reports speed pressure as a pain point</div>
      <div class="chart-container chart-container-tall"><canvas id="chart-pressure-role"></canvas></div>
    </div>
    <div class="card">
      <div class="card-title">Pain Points by Modeling Approach</div>
      <div class="card-subtitle">Does intentional modeling reduce pain? Let's find out.</div>
      <div class="chart-container chart-container-tall"><canvas id="chart-pain-model"></canvas></div>
    </div>
  </div>

  <div class="card">
    <div class="card-title">The Bottleneck Landscape</div>
    <div class="card-subtitle">Biggest bottlenecks, colored by whether the org uses orchestration</div>
    <div class="chart-container"><canvas id="chart-bottleneck-orch"></canvas></div>
    <div class="insight-box danger" style="margin-top:12px">
      <div class="insight-label">üî• Key Finding</div>
      Organizations without orchestration are disproportionately bottlenecked by "lack of clear ownership" and "fighting fires."
      Orchestration isn't just a tooling choice ‚Äî it's a proxy for organizational maturity.
    </div>
  </div>

  <div class="card">
    <div class="card-title">üîó Pain Chain: Connecting the Dots</div>
    <div class="card-subtitle">Following the causal chain from org characteristics to pain outcomes</div>
    <div id="pain-chain"></div>
  </div>
</div>

<!-- SECTION: Voices -->
<div class="section" id="sec-voices">
  <h2 class="section-title">üí¨ What the Industry Wishes You Knew</h2>
  <p class="section-desc">
    We analyzed 600+ open-ended responses to the question "What should the industry understand about data engineering?"
    Here are the dominant themes, extracted and quantified.
  </p>

  <div class="card">
    <div class="card-title">Top Themes from Open-Ended Responses</div>
    <div class="card-subtitle">Themes extracted via keyword analysis of "industry_wish" field</div>
    <div class="tag-cloud" id="theme-cloud"></div>
  </div>

  <div class="grid-2">
    <div class="card">
      <div class="card-title">üìä Theme Frequency</div>
      <div class="card-subtitle">How often each theme appears in open-ended responses</div>
      <div class="chart-container chart-container-tall"><canvas id="chart-themes"></canvas></div>
    </div>
    <div class="card">
      <div class="card-title">üìù Selected Quotes by Theme</div>
      <div class="card-subtitle">Real voices from real data professionals</div>
      <div class="table-scroll" id="quotes-list" style="max-height:500px"></div>
    </div>
  </div>
</div>

<!-- SECTION: Explorer -->
<div class="section" id="sec-crosstab">
  <h2 class="section-title">üî¨ Interactive Explorer</h2>
  <p class="section-desc">
    Build your own cross-tabulations. Select two dimensions and see how they relate.
  </p>

  <div class="filter-bar">
    <label>Rows:</label>
    <select id="xt-rows"></select>
    <label>Columns:</label>
    <select id="xt-cols"></select>
    <label>Show as:</label>
    <select id="xt-metric">
      <option value="count">Count</option>
      <option value="row_pct">Row %</option>
      <option value="col_pct">Col %</option>
    </select>
    <button onclick="runExplorerCrosstab()" style="background:var(--accent);color:#000;border:none;padding:8px 20px;border-radius:8px;font-weight:600;cursor:pointer;font-family:inherit">Generate</button>
  </div>

  <div class="card" id="explorer-results">
    <div style="text-align:center;padding:40px;color:var(--text-dim)">
      Select two dimensions above and click <strong>Generate</strong> to explore.
    </div>
  </div>

  <div class="card" style="display:none" id="explorer-chart-card">
    <div class="card-title">Visualization</div>
    <div class="chart-container"><canvas id="chart-explorer"></canvas></div>
  </div>
</div>

<div class="footer">
  <p>
    Built for the <a href="https://joereis.github.io/practical_data_data_eng_survey/" target="_blank">2026 State of Data Engineering Survey Hackathon</a>
    &nbsp;‚Ä¢&nbsp; #PracticalDataSurvey &nbsp;‚Ä¢&nbsp; Data: 1,101 responses
  </p>
  <p style="margin-top:8px">
    Analysis by <strong>Narendra</strong> &nbsp;‚Ä¢&nbsp;
    <a href="https://joereis.github.io/practical_data_data_eng_survey/" target="_blank">View Original Report ‚Üí</a>
  </p>
</div>

<script>
// ============================================
// DATA LOADING & PARSING
// ============================================

const ROLE_MAP = {"0":"Manager/Director/VP","1":"Data Architect","2":"Platform Engineer","3":"Analytics Engineer","4":"BI Engineer","5":"Data Engineer","6":"Team of 1","8":"Analyst","9":"Data Analyst","10":"Startup Founder","11":"Software Engineer (data)","12":"ML Engineer / MLOps","13":"BI Leader","14":"All of above","15":"Agile Data Coach","16":"CDO","17":"Associate","18":"Data Analyst","19":"Data & AI Engineer","20":"BI & Data Engineering","21":"Product Analyst","22":"AI Engineer","23":"Founder","24":"Founder","25":"Technical Account Mgr","26":"Ops System Designer","27":"Data Gov Consultant","28":"BI Analyst","29":"Migration Consultant","30":"Report Developer","31":"Data Products","32":"BI Functional Analyst","33":"Data Analyst","34":"Data PM","36":"Data Scientist","37":"BI Developer","38":"Solution Architect","39":"MLOps/ML Engineer","40":"Nonprofit Director","41":"Product Manager","42":"Product Manager","43":"Data Scientist","44":"BI Specialist","45":"DevRel Engineer","46":"Data Business Analyst","47":"SRE","48":"All of the above","49":"Tech Strategist","50":"Product Manager","51":"Data Modeller","52":"Consultant","53":"Head of Dev","54":"Standards Developer","55":"ML Professor","56":"Data Platform PM","57":"DE & Mainframe Dev","58":"Knowledge Engineer","59":"Data Analyst","63":"Sales Engineer","64":"Field CTO","65":"Job Seeker","66":"Data Product Manager","71":"Data & Analytics Eng","75":"BI Engineer","76":"CTO","77":"BI Consultant","78":"BI Analyst","79":"Practice Lead","80":"Senior Analyst","81":"Data Intelligence","82":"Business Intelligence","83":"Data Modeler","84":"Product Data Analyst","87":"DE Consultant","88":"Data Gov Lead","89":"Sales Engineer","90":"Business Owner","91":"Data/ML/AI Consultant","93":"AI Platform Founder"};
const ORGSIZE_MAP = {"0":"< 50","1":"200‚Äì999","2":"1,000‚Äì10,000","3":"10,000+","4":"50‚Äì199"};
const INDUSTRY_MAP = {"0":"Tech","1":"Public Sector/Edu","2":"Manufacturing","3":"Finance","4":"Retail/E-commerce","5":"Healthcare"};
const AI_FREQ_MAP = {"0":"Multiple times/day","1":"Weekly","2":"Daily","3":"Rarely","4":"Never"};
const AI_ADOPT_MAP = {"0":"Using AI for tactical tasks","1":"Experimenting","2":"Building internal AI platforms","3":"AI embedded in most workflows","4":"No meaningful adoption yet"};
const REGION_MAP = {"0":"United States / Canada","1":"Europe (EU / UK)","2":"Asia‚ÄìPacific","3":"Latin America","4":"Middle East / Africa","5":"Australia / NZ","6":"Other","7":"Europe (EU / UK)","8":"Latin America","9":"Asia‚ÄìPacific","10":"Other","11":"Other","12":"Other"};
const MODELING_MAP = {"0":"Kimball dimensional","1":"Mixed (depends on use case)","2":"Ad-hoc / tables as needed","3":"Canonical/semantic","4":"One Big Table","5":"Event-driven","6":"3NF","7":"Data Vault","8":"Medallion"};
const GROWTH_MAP = {"Grow":"Grow","Shrink":"Shrink","Stay the same":"Stay the same","Not sure":"Not sure"};
const STORAGE_MAP = {"0":"Cloud PostgreSQL/MySQL","1":"Mixed/hybrid","2":"Cloud DWH (Snowflake, BQ, Redshift)","3":"Lakehouse (Databricks, Iceberg, etc)","4":"On-prem data lake","5":"On-prem DWH"};

// Simplified pain mapping
const PAIN_KEYS = {
  "0":"None / going well",
  "1":"Lack of ownership + Speed pressure",
  "2":"Lack of ownership + Tools",
  "3":"Hard to maintain + Speed pressure",
  "4":"Lack of ownership + Hard to maintain",
  "5":"Speed pressure",
  "6":"Lack of ownership",
  "7":"Hard to maintain + Tools + Speed pressure + AI schemas",
  "8":"Tools + Speed pressure",
  "9":"All pain points",
  "10":"Speed pressure + AI schemas",
  "11":"Lack of ownership + Hard to maintain + Speed pressure",
  "12":"Lack of ownership + Hard to maintain + Tools + Speed pressure",
  "13":"Hard to maintain",
  "14":"Hard to maintain + Tools + AI schemas",
  "15":"Lack of ownership + Tools + Speed pressure",
  "16":"Lack of ownership + Hard to maintain + Tools",
  "17":"Tools don't support modeling",
  "21":"Hard to maintain + Tools",
  "24":"Hard to maintain + Tools + Speed pressure",
  "25":"AI tools produce inconsistent schemas",
  "27":"Lack of ownership + Speed pressure + AI schemas",
  "28":"Lack of ownership + Hard to maintain + Speed + AI schemas",
  "29":"Lack of ownership + None"
};

const BOTTLENECK_MAP = {"0":"Data quality issues","2":"Stakeholder alignment","3":"Hiring / talent gaps","4":"Legacy systems","6":"Budget / resources","7":"Lack of clear ownership","8":"Technical debt"};
const ARCH_MAP = {"0":"Cloud-first migration","1":"Lakehouse convergence","3":"Multi-cloud / hybrid","4":"Real-time / streaming focus"};
const EDUCATION_MAP = {"0":"Data modeling","1":"Architecture patterns","2":"AI / ML for DE","3":"Data quality","4":"Leadership / soft skills","5":"Cloud platforms","6":"Other"};

let DATA = [];

function simplifyRole(code) {
  const c = String(code).trim();
  if (["0","13","16"].includes(c)) return "Manager/Director/VP";
  if (["1"].includes(c)) return "Data Architect";
  if (["2"].includes(c)) return "Platform Engineer";
  if (["3"].includes(c)) return "Analytics Engineer";
  if (["4","75"].includes(c)) return "BI Engineer";
  if (["5"].includes(c)) return "Data Engineer";
  if (["11"].includes(c)) return "Software Eng (data)";
  if (["12"].includes(c)) return "ML Engineer / MLOps";
  if (["22"].includes(c)) return "AI Engineer";
  if (["8","9","18","33","59","78","82","84"].includes(c)) return "Data Analyst";
  if (["36","43"].includes(c)) return "Data Scientist";
  if (["37","44","28","30","32"].includes(c)) return "BI Role";
  if (["41","42","50","66","34"].includes(c)) return "Product/PM";
  return "Other";
}

function simplifyRegion(code) {
  const c = String(code).trim();
  const mapped = REGION_MAP[c];
  if (!mapped) return "Other";
  if (mapped.includes("United States")) return "N. America";
  if (mapped.includes("Europe")) return "Europe";
  if (mapped.includes("Asia")) return "Asia-Pacific";
  if (mapped.includes("Latin")) return "Latin America";
  if (mapped.includes("Australia")) return "ANZ";
  if (mapped.includes("Middle East")) return "ME / Africa";
  return "Other";
}

function hasOrchestration(orch) {
  if (!orch) return false;
  const lower = orch.toLowerCase();
  return !lower.includes("no orchestration") && !lower.includes("not sure") && lower.trim() !== "";
}

function hasPain(painCode) {
  return painCode !== "0" && painCode !== "";
}

function painContains(painCode, keyword) {
  const mapped = PAIN_KEYS[String(painCode)] || "";
  return mapped.toLowerCase().includes(keyword.toLowerCase());
}

async function loadData() {
  try {
    const resp = await fetch('survey_2026_data_engineering.csv');
    const text = await resp.text();
    const lines = text.split('\n').filter(l => l.trim());
    const headers = parseCSVLine(lines[0]);

    for (let i = 1; i < lines.length; i++) {
      const vals = parseCSVLine(lines[i]);
      if (vals.length < 10) continue;
      const row = {};
      headers.forEach((h, idx) => { row[h] = (vals[idx] || '').trim(); });

      // Decode fields
      row._role = simplifyRole(row.role);
      row._orgsize = ORGSIZE_MAP[row.org_size] || row.org_size || "Unknown";
      row._industry = INDUSTRY_MAP[row.industry] || "Other";
      row._region = simplifyRegion(row.region);
      row._ai_freq = AI_FREQ_MAP[row.ai_usage_frequency] || row.ai_usage_frequency || "Unknown";
      row._ai_adopt = AI_ADOPT_MAP[row.ai_adoption] || "Unknown";
      row._modeling = MODELING_MAP[row.modeling_approach] || "Other";
      row._growth = row.team_growth_2026 || "Unknown";
      row._storage = STORAGE_MAP[row.storage_environment] || "Other";
      row._orch = row.orchestration || "";
      row._has_orch = hasOrchestration(row.orchestration);
      row._bottleneck = BOTTLENECK_MAP[row.biggest_bottleneck] || "Other";
      row._architecture = ARCH_MAP[row.architecture_trend] || "Other";
      row._education = EDUCATION_MAP[row.education_topic] || "Other";
      row._pain_code = row.modeling_pain_points || "";
      row._has_pain = hasPain(row.modeling_pain_points);
      row._wish = row.industry_wish || "";

      // Maturity score (0-4)
      let maturity = 0;
      if (row._has_orch) maturity++;
      if (["Kimball dimensional","Mixed (depends on use case)","Canonical/semantic","Data Vault","Event-driven","3NF","Medallion"].includes(row._modeling)) maturity++;
      if (["Cloud DWH (Snowflake, BQ, Redshift)","Lakehouse (Databricks, Iceberg, etc)"].includes(row._storage)) maturity++;
      if (["Building internal AI platforms","AI embedded in most workflows","Using AI for tactical tasks"].includes(row._ai_adopt)) maturity++;
      row._maturity = maturity;
      row._maturity_tier = maturity <= 1 ? "Early" : maturity <= 2 ? "Growing" : "Mature";

      // AI daily user flag
      row._ai_daily = ["Multiple times/day","Daily"].includes(row._ai_freq);

      DATA.push(row);
    }

    document.getElementById('loading-screen').style.display = 'none';
    document.getElementById('sec-overview').style.display = 'block';

    renderAll();
  } catch(e) {
    document.getElementById('loading-screen').innerHTML = '<div style="color:#ef4444">Error loading data: ' + e.message + '<br><br>Make sure <code>survey_2026_data_engineering.csv</code> is in the same directory.</div>';
    console.error(e);
  }
}

function parseCSVLine(line) {
  const result = [];
  let current = '';
  let inQuotes = false;
  for (let i = 0; i < line.length; i++) {
    const ch = line[i];
    if (ch === '"') {
      if (inQuotes && line[i+1] === '"') { current += '"'; i++; }
      else { inQuotes = !inQuotes; }
    } else if (ch === ',' && !inQuotes) {
      result.push(current); current = '';
    } else {
      current += ch;
    }
  }
  result.push(current);
  return result;
}

// ============================================
// UTILITY FUNCTIONS
// ============================================
function countBy(arr, key) {
  const counts = {};
  arr.forEach(r => {
    const v = typeof key === 'function' ? key(r) : r[key];
    counts[v] = (counts[v] || 0) + 1;
  });
  return counts;
}

function sortedEntries(obj, desc=true) {
  return Object.entries(obj).sort((a,b) => desc ? b[1]-a[1] : a[1]-b[1]);
}

function pct(n, total) {
  return total > 0 ? (n/total*100).toFixed(1) : "0.0";
}

const COLORS = {
  blue: ['#38bdf8','#0ea5e9','#0284c7','#0369a1','#075985'],
  purple: ['#818cf8','#6366f1','#4f46e5','#4338ca','#3730a3'],
  green: ['#34d399','#10b981','#059669','#047857','#065f46'],
  orange: ['#fb923c','#f97316','#ea580c','#c2410c','#9a3412'],
  pink: ['#f472b6','#ec4899','#db2777','#be185d','#9d174d'],
  mixed: ['#38bdf8','#818cf8','#34d399','#fb923c','#f472b6','#eab308','#ef4444','#06b6d4','#8b5cf6','#f43f5e','#14b8a6','#a855f7'],
  tiers: ['#ef4444','#eab308','#22c55e'],
};

function makeChart(canvasId, type, labels, datasets, opts={}) {
  const ctx = document.getElementById(canvasId);
  if (!ctx) return null;
  return new Chart(ctx, {
    type,
    data: { labels, datasets },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      indexAxis: opts.horizontal ? 'y' : 'x',
      plugins: {
        legend: { display: opts.legend !== false, position: opts.legendPos || 'top', labels: { color: '#94a3b8', font: { size: 11 } } },
        tooltip: { backgroundColor: '#1e293b', titleColor: '#e2e8f0', bodyColor: '#e2e8f0', borderColor: '#475569', borderWidth: 1 },
        datalabels: opts.datalabels || false
      },
      scales: type === 'bar' || type === 'line' ? {
        x: { ticks: { color: '#94a3b8', font: { size: 10 }, maxRotation: opts.horizontal ? 0 : 45 }, grid: { color: 'rgba(71,85,105,0.3)' } },
        y: { ticks: { color: '#94a3b8', font: { size: 10 } }, grid: { color: 'rgba(71,85,105,0.3)' }, beginAtZero: true, ...(opts.yMax ? {max: opts.yMax} : {}), ...(opts.stacked ? {stacked: true} : {}) },
        ...(opts.stacked ? {x:{stacked:true, ticks:{color:'#94a3b8',font:{size:10}}, grid:{color:'rgba(71,85,105,0.3)'}}} : {})
      } : undefined,
      ...opts.extra
    }
  });
}

// ============================================
// RENDER ALL SECTIONS
// ============================================
function renderAll() {
  renderOverview();
  renderAIDeep();
  renderRegional();
  renderMaturity();
  renderPain();
  renderVoices();
  setupExplorer();
}

// ============================================
// OVERVIEW
// ============================================
function renderOverview() {
  const n = DATA.length;
  const dailyAI = DATA.filter(r => r._ai_daily).length;
  const experimenting = DATA.filter(r => r._ai_adopt === "Experimenting").length;
  const growExpect = DATA.filter(r => r._growth === "Grow").length;
  const hasPainN = DATA.filter(r => r._has_pain).length;
  const noOrch = DATA.filter(r => !r._has_orch).length;
  const adHocModel = DATA.filter(r => r._modeling === "Ad-hoc / tables as needed" || r._modeling === "One Big Table").length;

  const kpis = [
    { value: n.toLocaleString(), label: "Total Responses", detail: "Data professionals worldwide", color: "blue" },
    { value: pct(dailyAI, n) + "%", label: "Daily AI Users", detail: `${dailyAI} use AI daily or more`, color: "purple" },
    { value: pct(experimenting, n) + "%", label: "Still 'Experimenting' with AI", detail: `Org-level adoption ‚Äî the gap is real`, color: "orange" },
    { value: pct(growExpect, n) + "%", label: "Expect Team Growth", detail: `${growExpect} respondents optimistic`, color: "green" },
    { value: pct(hasPainN, n) + "%", label: "Report Modeling Pain", detail: `${hasPainN} have pain points`, color: "red" },
    { value: pct(noOrch, n) + "%", label: "No Orchestration", detail: `${noOrch} run ad-hoc pipelines`, color: "pink" },
  ];

  document.getElementById('kpi-grid').innerHTML = kpis.map(k => `
    <div class="kpi-card ${k.color}">
      <div class="kpi-value ${k.color}">${k.value}</div>
      <div class="kpi-label">${k.label}</div>
      <div class="kpi-detail">${k.detail}</div>
    </div>
  `).join('');

  // AI Paradox chart
  const freqCounts = countBy(DATA, '_ai_freq');
  const adoptCounts = countBy(DATA, '_ai_adopt');
  const freqOrder = ["Multiple times/day","Daily","Weekly","Rarely","Never"];
  const adoptOrder = ["AI embedded in most workflows","Building internal AI platforms","Using AI for tactical tasks","Experimenting","No meaningful adoption yet"];

  makeChart('chart-ai-paradox', 'bar',
    ['Individual Usage', 'Org Adoption'],
    [
      { label: freqOrder[0], data: [freqCounts[freqOrder[0]]||0, adoptCounts[adoptOrder[0]]||0], backgroundColor: COLORS.blue[0] },
      { label: freqOrder[1], data: [freqCounts[freqOrder[1]]||0, adoptCounts[adoptOrder[1]]||0], backgroundColor: COLORS.blue[1] },
      { label: freqOrder[2], data: [freqCounts[freqOrder[2]]||0, adoptCounts[adoptOrder[2]]||0], backgroundColor: COLORS.blue[2] },
      { label: freqOrder[3]||"Rarely/Never", data: [(freqCounts[freqOrder[3]]||0)+(freqCounts[freqOrder[4]]||0), (adoptCounts[adoptOrder[3]]||0)+(adoptCounts[adoptOrder[4]]||0)], backgroundColor: COLORS.blue[3] },
    ],
    { legend: true }
  );

  // Growth by AI adoption
  const growthByAdopt = {};
  adoptOrder.forEach(a => { growthByAdopt[a] = {Grow:0, "Stay the same":0, Shrink:0, "Not sure":0}; });
  DATA.forEach(r => {
    if (growthByAdopt[r._ai_adopt]) {
      const g = r._growth;
      if (growthByAdopt[r._ai_adopt][g] !== undefined) growthByAdopt[r._ai_adopt][g]++;
    }
  });

  const shortAdopt = ["AI embedded","Building platforms","Tactical AI","Experimenting","No adoption"];
  makeChart('chart-growth-ai', 'bar', shortAdopt,
    [
      { label: 'Grow', data: adoptOrder.map(a => growthByAdopt[a]?.Grow || 0), backgroundColor: '#22c55e' },
      { label: 'Stay same', data: adoptOrder.map(a => growthByAdopt[a]?.["Stay the same"] || 0), backgroundColor: '#eab308' },
      { label: 'Shrink', data: adoptOrder.map(a => growthByAdopt[a]?.Shrink || 0), backgroundColor: '#ef4444' },
      { label: 'Not sure', data: adoptOrder.map(a => growthByAdopt[a]?.["Not sure"] || 0), backgroundColor: '#64748b' },
    ],
    { stacked: true, legend: true }
  );

  // No orchestration by org size
  const orgOrder = ["< 50","50‚Äì199","200‚Äì999","1,000‚Äì10,000","10,000+"];
  const orchByOrg = {};
  orgOrder.forEach(o => { orchByOrg[o] = {total:0, noOrch:0}; });
  DATA.forEach(r => {
    if (orchByOrg[r._orgsize]) {
      orchByOrg[r._orgsize].total++;
      if (!r._has_orch) orchByOrg[r._orgsize].noOrch++;
    }
  });

  makeChart('chart-orch-orgsize', 'bar', orgOrder,
    [{ label: '% with No Orchestration', data: orgOrder.map(o => orchByOrg[o]?.total > 0 ? parseFloat(pct(orchByOrg[o].noOrch, orchByOrg[o].total)) : 0), backgroundColor: COLORS.orange.slice(0,5), borderRadius: 6 }],
    { legend: false, yMax: 60 }
  );
}

// ============================================
// AI DEEP DIVE
// ============================================
function renderAIDeep() {
  // What AI helps with (multi-select parsing)
  const aiHelpsMap = {"0":"Writing Code","1":"Architecture design","2":"Documentation","3":"Architecture design","4":"Governance/quality","5":"Code + Governance","6":"Documentation + Architecture","7":"Documentation + Data modeling","8":"Code + Pipeline debugging","9":"Writing Code (only)","10":"AI not helpful","11":"Code + Data modeling","12":"Code (not helpful)","13":"Code + Debugging + Docs","14":"Code + Docs + Architecture","15":"Code + Debug + Docs + Modeling + Architecture","16":"Code + Debug + Architecture","20":"Debug + Docs"};

  const helpTasks = {"Writing Code":0,"Pipeline debugging":0,"Documentation":0,"Data modeling":0,"Architecture design":0,"Governance/quality":0,"Not helpful":0};

  DATA.forEach(r => {
    const raw = r.ai_helps_with || "";
    const mapped = aiHelpsMap[raw] || raw;
    if (!mapped) return;
    const lower = mapped.toLowerCase();
    if (lower.includes("code") || lower.includes("writing")) helpTasks["Writing Code"]++;
    if (lower.includes("debug") || lower.includes("pipeline")) helpTasks["Pipeline debugging"]++;
    if (lower.includes("doc") || lower.includes("discovery")) helpTasks["Documentation"]++;
    if (lower.includes("model")) helpTasks["Data modeling"]++;
    if (lower.includes("architect")) helpTasks["Architecture design"]++;
    if (lower.includes("govern") || lower.includes("quality")) helpTasks["Governance/quality"]++;
    if (lower.includes("not helpful") || lower.includes("don't find")) helpTasks["Not helpful"]++;
  });

  const helpEntries = sortedEntries(helpTasks);
  makeChart('chart-ai-helps', 'bar',
    helpEntries.map(e => e[0]),
    [{ label: 'Mentions', data: helpEntries.map(e => e[1]), backgroundColor: COLORS.mixed.slice(0, helpEntries.length), borderRadius: 6 }],
    { horizontal: true, legend: false }
  );

  // AI adoption by org size
  const orgOrder = ["< 50","50‚Äì199","200‚Äì999","1,000‚Äì10,000","10,000+"];
  const adoptLevels = ["AI embedded in most workflows","Building internal AI platforms","Using AI for tactical tasks","Experimenting","No meaningful adoption yet"];
  const aiOrgData = {};
  orgOrder.forEach(o => { aiOrgData[o] = {}; adoptLevels.forEach(a => aiOrgData[o][a] = 0); });
  DATA.forEach(r => {
    if (aiOrgData[r._orgsize] && aiOrgData[r._orgsize][r._ai_adopt] !== undefined) {
      aiOrgData[r._orgsize][r._ai_adopt]++;
    }
  });

  const aiOrgColors = ['#22c55e','#38bdf8','#818cf8','#eab308','#ef4444'];
  makeChart('chart-ai-orgsize', 'bar', orgOrder,
    adoptLevels.map((a,i) => ({
      label: a.replace("Using AI for tactical tasks","Tactical AI").replace("Building internal AI platforms","Building Platforms").replace("AI embedded in most workflows","AI Embedded").replace("No meaningful adoption yet","No Adoption"),
      data: orgOrder.map(o => aiOrgData[o]?.[a] || 0),
      backgroundColor: aiOrgColors[i]
    })),
    { stacked: true, legend: true, legendPos: 'bottom' }
  );

  // AI not helpful cohort
  const notHelpful = DATA.filter(r => {
    const h = r.ai_helps_with || "";
    return h === "10" || h === "12" || h === "42" || h === "44" || h === "48" || h === "28";
  });

  const nhRoles = countBy(notHelpful, '_role');
  const nhOrg = countBy(notHelpful, '_orgsize');
  const nhRegion = countBy(notHelpful, '_region');

  let nhHtml = `<div class="insight-box warning">
    <div class="insight-label">Finding</div>
    <strong>${notHelpful.length} respondents</strong> (${pct(notHelpful.length, DATA.length)}%) explicitly say AI is NOT helpful for their work. Here's their profile:
  </div>`;
  nhHtml += '<div class="grid-3">';
  nhHtml += '<div><strong style="color:var(--text-dim);font-size:12px">BY ROLE</strong><br>' + sortedEntries(nhRoles).slice(0,5).map(e => `${e[0]}: ${e[1]}`).join('<br>') + '</div>';
  nhHtml += '<div><strong style="color:var(--text-dim);font-size:12px">BY ORG SIZE</strong><br>' + sortedEntries(nhOrg).map(e => `${e[0]}: ${e[1]}`).join('<br>') + '</div>';
  nhHtml += '<div><strong style="color:var(--text-dim);font-size:12px">BY REGION</strong><br>' + sortedEntries(nhRegion).slice(0,4).map(e => `${e[0]}: ${e[1]}`).join('<br>') + '</div>';
  nhHtml += '</div>';
  document.getElementById('ai-not-helpful-analysis').innerHTML = nhHtml;

  // Daily vs rare users
  const daily = DATA.filter(r => r._ai_daily);
  const rare = DATA.filter(r => r._ai_freq === "Rarely" || r._ai_freq === "Never");

  const dailyGrow = pct(daily.filter(r => r._growth === "Grow").length, daily.length);
  const rareGrow = pct(rare.filter(r => r._growth === "Grow").length, rare.length);
  const dailyPain = pct(daily.filter(r => r._has_pain).length, daily.length);
  const rarePain = pct(rare.filter(r => r._has_pain).length, rare.length);
  const dailyOrch = pct(daily.filter(r => r._has_orch).length, daily.length);
  const rareOrch = pct(rare.filter(r => r._has_
